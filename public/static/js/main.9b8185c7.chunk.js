(this.webpackJsonpsimplecms=this.webpackJsonpsimplecms||[]).push([[0],{267:function(e,t){},287:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(66),c=n.n(r),o=n(30),s=n(398),l=n(370),u=n(87),d=n(80),j=Object(d.b)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:u.a.A400}}}),b=n(7),f=n(385),h=n(15),O=n(12),p=n(386),x=n(222),m=n(6),v=n(382),g=n(88),y=n(138),w=n(381),S=n(202),C=n.n(S),k=n(25),_=n(68),q=n(353),P=new(function(){function e(){Object(k.a)(this,e),this.loadingSubject=new q.a(!1)}return Object(_.a)(e,[{key:"setLoading",value:function(e){this.loadingSubject.next(e)}},{key:"subscribe",value:function(){return this.loadingSubject.asObservable()}}]),e}()),F=n(371),I=n(354),E=n(380),T=n(199),D=n(355),M=n(356),N=n(357),z=n(152),W=n.n(z),L=W.a.create({timeout:6e3,headers:{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"XMLHttpRequest"},withCredentials:!0});var A=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(F.a)({}).pipe(Object(I.a)((function(){return P.setLoading(!0)})),Object(E.a)((function(){return L.request(Object.assign({},n,{url:e,method:t}))})),Object(T.a)((function(e){return e.data})),Object(D.a)((function(e){return Object(M.a)(e)})),Object(N.a)((function(){return P.setLoading(!1)})))},H=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{headers:{"Content-Type":"multipart/form-data"}};return Object(F.a)({}).pipe(Object(I.a)((function(){return P.setLoading(!0)})),Object(E.a)((function(){return W.a.post(e,t,n)})),Object(T.a)((function(e){return e})),Object(D.a)((function(e){return Object(M.a)(e)})),Object(N.a)((function(){return P.setLoading(!1)})))},R=new function e(){Object(k.a)(this,e),this.getList=function(e){return A("/admin/article/list","GET",{params:e})},this.getDetail=function(e){return A("/admin/article/info","GET",{params:{id:e}})},this.create=function(e){return A("/admin/article/add","POST",{data:e})},this.edit=function(e){return A("/admin/article/edit","POST",{data:e})},this.delete=function(e){return A("/admin/article/del","POST",{data:{id:e}})},this.publish=function(e){return A("/admin/article/publish","POST",{params:{id:e}})},this.withdraw=function(e){return A("/admin/article/withdraw","POST",{params:{id:e}})}},B=new function e(){Object(k.a)(this,e),this.getList=function(e){return A("/admin/article/type/list","GET",{params:{category:e}})},this.creat=function(e){return A("/admin/article/type/add","POST",{data:e})},this.edit=function(e){return A("/admin/article/type/edit","POST",{data:e})},this.delete=function(e){return A("/admin/article/type/del","POST",{data:{id:e}})}},G=new function e(){Object(k.a)(this,e),this.postImage=function(e){return H("/admin/upload/image",e)},this.postVideo=function(e){return H("/admin/upload/video",e)}},X=n(215),K=n(358),U=new function e(){var t=this;Object(k.a)(this,e),this.actionSubject=new X.a,this.save=function(){t.actionSubject.next("save")},this.publish=function(){t.actionSubject.next("publish")},this.withdraw=function(){t.actionSubject.next("withdraw")},this.handleAction=function(e){return t.actionSubject.pipe(Object(K.a)((function(t){return t===e})))}},V=n(200),J=n.n(V),Y=new function e(){Object(k.a)(this,e),this.signIn=function(e){var t=e.email,n=e.password,a=e.code,i=J()(n).toString();return console.log("earo say the pwd",n,i),A("/admin/login","POST",{data:{email:t,password:i,code:a}})},this.signOut=function(){return A("/admin/sign","GET")}},Q=new(function(){function e(){Object(k.a)(this,e),this._portalMessageSubject=new q.a(null)}return Object(_.a)(e,[{key:"publish",value:function(e){this._portalMessageSubject.next(e)}},{key:"onMessage",value:function(e){return this._portalMessageSubject.pipe(Object(K.a)((function(t){return(null===t||void 0===t?void 0:t.type)===e})),Object(T.a)((function(e){return e.body})))}}]),e}()),Z=new function e(){Object(k.a)(this,e),this.getUserInfo=function(){return A("/admin/self/user/info","GET")}},$=function(e){var t=e.children,n=e.channel;return Object(a.useEffect)((function(){Q.publish({type:n,body:t})}),[t,n]),null},ee="appBarTitle",te=n(1),ne=Object(m.a)(w.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(O.a)({zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},n&&{marginLeft:"200px",transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})})})),ae=function(e){var t=e.open,n=e.toggleDrawer,i=Object(a.useState)(null),r=Object(b.a)(i,2),c=r[0],o=r[1];return Object(a.useEffect)((function(){var e=Q.onMessage(ee).subscribe((function(e){o(e)}));return function(){e.unsubscribe()}}),[]),Object(te.jsx)(ne,{position:"absolute",open:t,children:Object(te.jsxs)(v.a,{sx:{pr:"24px"},children:[Object(te.jsx)(g.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:n,sx:{marginRight:"36px"},children:Object(te.jsx)(C.a,{})}),Object(te.jsx)(y.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1},children:c})]})})},ie=n(3),re=n(366),ce=n(384),oe=n(374),se=n(218),le=n(367),ue=n(383),de=n(206),je=n.n(de),be=n(207),fe=n.n(be),he=n(208),Oe=n.n(he),pe=n(209),xe=n.n(pe),me=n(210),ve=n.n(me),ge=function(e){return{width:200,marginTop:"64px",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}},ye=Object(m.a)("div")((function(e){var t=e.theme;return Object(O.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(-1,1)},t.mixins.toolbar)})),we=Object(m.a)(ue.a)((function(e){var t,n=e.theme,a=e.open;return Object(O.a)(Object(O.a)({width:200,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},a&&{width:200,transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen}),overflowX:"hidden","& .MuiDrawer-paper":ge(n)}),!a&&(t={transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(n.spacing(7)," + 1px)")},Object(ie.a)(t,n.breakpoints.up("sm"),{width:"calc(".concat(n.spacing(9)," + 1px)")}),Object(ie.a)(t,"& .MuiDrawer-paper",function(e){return Object(ie.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginTop:"64px",overflowX:"hidden",width:"calc(".concat(e.spacing(6)," + 1px)")},e.breakpoints.up("sm"),{width:"calc(".concat(e.spacing(7)," + 1px)")})}(n)),t))})),Se=function(e){var t=e.open;e.toggleDrawer;return Object(te.jsxs)(we,{variant:"permanent",open:t,children:[Object(te.jsx)(re.a,{}),Object(te.jsx)(ce.a,{children:Object(te.jsxs)("div",{children:[Object(te.jsx)(o.b,{to:"/admin/products",children:Object(te.jsxs)(oe.a,{children:[Object(te.jsx)(se.a,{children:Object(te.jsx)(je.a,{})}),Object(te.jsx)(le.a,{primary:"\u4ea7\u54c1\u4e2d\u5fc3"})]})}),Object(te.jsx)(o.b,{to:"/admin/applications",children:Object(te.jsxs)(oe.a,{children:[Object(te.jsx)(se.a,{children:Object(te.jsx)(fe.a,{})}),Object(te.jsx)(le.a,{primary:"\u884c\u4e1a\u5e94\u7528"})]})}),Object(te.jsx)(o.b,{to:"/admin/news",children:Object(te.jsxs)(oe.a,{children:[Object(te.jsx)(se.a,{children:Object(te.jsx)(Oe.a,{})}),Object(te.jsx)(le.a,{primary:"\u65b0\u95fb\u4e2d\u5fc3"})]})}),Object(te.jsx)(o.b,{to:"/admin/others",children:Object(te.jsxs)(oe.a,{children:[Object(te.jsx)(se.a,{children:Object(te.jsx)(xe.a,{})}),Object(te.jsx)(le.a,{primary:"\u5176\u4ed6"})]})})]})}),Object(te.jsx)(re.a,{}),Object(te.jsx)(ce.a,{children:Object(te.jsx)("div",{children:Object(te.jsx)(o.b,{to:"/admin/settings",children:Object(te.jsxs)(oe.a,{children:[Object(te.jsx)(se.a,{children:Object(te.jsx)(ve.a,{})}),Object(te.jsx)(le.a,{primary:"\u7a3f\u4ef6\u7c7b\u578b\u7ba1\u7406"})]})})})})]})},Ce=function(e){var t=e.children,n=Object(a.useState)(!0),i=Object(b.a)(n,2),r=i[0],c=i[1],o=function(){c(!r)};return Object(te.jsxs)(a.Fragment,{children:[Object(te.jsx)(ae,{open:r,toggleDrawer:o}),Object(te.jsx)(Se,{open:r,toggleDrawer:o}),Object(te.jsxs)(f.a,{component:"main",sx:Object(O.a)({flexGrow:1,height:"100vh",overflow:"auto",display:"flex",flexDirection:"column",marginLeft:"64px",transition:function(e){return e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})}},r&&{marginLeft:"200px",transition:function(e){return e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})}}),children:[Object(te.jsx)(ye,{}),Object(te.jsx)(p.a,{maxWidth:"lg",children:Object(te.jsx)(x.a,{sx:{mt:4,mb:4,height:"100%"},children:t})})]})]})},ke=function(e){return Object(te.jsx)(f.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:e.children})},_e=n(63),qe=n(394),Pe=n(160),Fe=n(128),Ie=n.n(Fe),Ee=n(129),Te=n.n(Ee),De=n(372),Me=Object(m.a)("div")((function(e){var t,n=e.theme;return{padding:n.spacing(.5,.5,0),justifyContent:"space-between",display:"flex",alignItems:"flex-start",flexWrap:"wrap","& MuiTextField-root":(t={},Object(ie.a)(t,n.breakpoints.down("xs"),{width:"100%"}),Object(ie.a)(t,"margin",n.spacing(1,.5,1.5)),Object(ie.a)(t,"& .MuiSvgIcon-root",{marginRight:n.spacing(.5)}),Object(ie.a)(t,"& .MuiInput-underline:before",{borderBottom:"1px solid ".concat(n.palette.divider)}),t)}})),Ne=new X.a,ze=function(e){var t=Object(a.useRef)(null);return Object(a.useEffect)((function(){var t=Ne.pipe(Object(De.a)(1500),Object(I.a)((function(t){e.setFilter((function(e){return Object(O.a)(Object(O.a)({},e),{},{kw:t,offset:0})}))}))).subscribe();return function(){t.unsubscribe()}}),[e]),Object(te.jsx)(Me,{children:Object(te.jsx)(Pe.a,{inputRef:t,variant:"standard",defaultValue:e.value,onChange:function(e){Ne.next(null===e||void 0===e?void 0:e.target.value)},placeholder:"\u5173\u952e\u5b57\u67e5\u627e",InputProps:{startAdornment:Object(te.jsx)(Ie.a,{fontSize:"small"}),endAdornment:Object(te.jsx)(g.a,{title:"Clear","aria-label":"Clear",size:"small",style:{visibility:e.value?"visible":"hidden"},onClick:function(){t.current.value="",Ne.next("")},children:Object(te.jsx)(Te.a,{fontSize:"small"})})}})})},We=n(64),Le=n.n(We),Ae=n(61),He=n.n(Ae),Re=n(62),Be=n.n(Re),Ge=n(389),Xe=n(390),Ke=n(391),Ue=n(392),Ve=n(393),Je=n(89),Ye=function(e){var t=e.open,n=e.message,a=e.onClose,i=e.onConfirm;return Object(te.jsxs)(Ge.a,{maxWidth:"xs",open:t,children:[Object(te.jsx)(Xe.a,{children:"\u786e\u8ba4\u5220\u9664"}),Object(te.jsx)(Ke.a,{dividers:!0,children:n&&Object(te.jsx)(Ue.a,{children:"\u786e\u8ba4\u5220\u9664?"})}),Object(te.jsxs)(Ve.a,{children:[Object(te.jsx)(Je.a,{autoFocus:!0,onClick:a,children:"\u53d6\u6d88"}),Object(te.jsx)(Je.a,{color:"warning",onClick:i,children:"\u786e\u8ba4"})]})]})},Qe=n(22),Ze=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:1}),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),c=Object(b.a)(r,2),s=c[0],l=c[1],u=Object(a.useState)(1),d=Object(b.a)(u,2),j=d[0],p=d[1],x=Object(a.useState)({open:!1}),m=Object(b.a)(x,2),v=m[0],w=m[1],S=Object(h.g)(),C=Object(Qe.b)();Object(a.useEffect)((function(){R.getList(n).subscribe((function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),p(n.total)):(console.error("fetch products error",t),C.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u5217\u8868\u5931\u8d25",{variant:"error"}))}),(function(e){console.error("fetch products error",e),C.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u5217\u8868\u5931\u8d25",{variant:"error"})}))}),[n,C]);var k=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(te.jsx)(o.b,{to:"/admin/products/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(te.jsx)(y.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(te.jsx)(y.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_time",headerName:"\u521b\u5efa\u65f6\u95f4",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(g.a,{component:o.b,to:"/admin/products/detail/".concat(e.row.id),children:Object(te.jsx)(He.a,{})}),Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void w({open:!0,message:'\u786e\u8ba4\u5220\u9664\u4ea7\u54c1\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){w({open:!1})},onConfirm:function(){R.delete(t.id).pipe(Object(I.a)((function(){i(Object(O.a)({},n)),w({open:!1}),C.enqueueSnackbar("\u5220\u9664\u4ea7\u54c1\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){C.enqueueSnackbar(" \u5220\u9664\u4ea7\u54c1\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(te.jsx)(Be.a,{})})]})}}];return Object(te.jsxs)(f.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(te.jsx)(_e.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:j,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:ze},componentsProps:{toolbar:{value:n.kw,setFilter:i}},columns:k,rows:s}),Object(te.jsx)(qe.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){S.push("/admin/products/create")},children:Object(te.jsx)(Le.a,{})}),Object(te.jsx)(Ye,Object(O.a)({},v)),Object(te.jsx)($,{channel:ee,children:"\u4ea7\u54c1\u4e2d\u5fc3"})]})},$e=n(76),et=n(378),tt=n(59),nt=n(396),at=n(397),it=n(77),rt=n(78),ct=n.n(rt),ot=n(395),st=function e(t){var n=this;Object(k.a)(this,e),this.loader=void 0,this._uploadTask=void 0,this.upload=function(){var e=new FormData;return n.loader.file.then((function(t){return e.append("file",t),Object(ot.a)(G.postImage(e)).then((function(e){return 0!==e.errcode?{default:"https://33333.cdn.cke-cs.com/rc1DFuFpHqcR3Mah6y0e/images/a941c59ff780060b51d398434c99fe9f229615b4227f5434.png"}:{default:e.data.url}})).catch((function(){return{default:"https://33333.cdn.cke-cs.com/rc1DFuFpHqcR3Mah6y0e/images/a941c59ff780060b51d398434c99fe9f229615b4227f5434.png"}}))}))},this.abort=function(){n._uploadTask.unsubscribe()},this.loader=t};function lt(e){e.plugins.get("FileRepository").createUploadAdapter=function(e){return new st(e)}}var ut=n(369),dt=function(e){var t,n,i,r,c,o=e.detail,s=Object(a.useState)(o),l=Object(b.a)(s,2),u=l[0],d=l[1],j=Object(a.useState)([]),p=Object(b.a)(j,2),m=p[0],v=p[1],g=Object(a.useState)(null),w=Object(b.a)(g,2),S=w[0],C=w[1],k=Object(h.g)(),_=Object(Qe.b)();Object(a.useEffect)((function(){d(o)}),[o]),Object(a.useEffect)((function(){B.getList(1).subscribe({next:function(e){var t=e.data.list;v(t)},error:function(e){console.error("fail to fetch article type list",e),_.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u7c7b\u578b\u4fe1\u606f\u5931\u8d25",{variant:"error"})}})}),[_]),Object(a.useEffect)((function(){if(u.type_id>=0){var e=m.find((function(e){var t;return e.id===(null===(t=u.type)||void 0===t?void 0:t.parent_id)}));C(e)}}),[m,u.type_id,u.type]),Object(a.useEffect)((function(){var e=U.handleAction("save").pipe(Object(ut.a)((function(){return u.id?R.edit({content:u.content,id:u.id,summary:u.summary,title:u.title,type_id:u.type_id,covers:u.covers.map((function(e){return e.img}))}):R.create({category:1,content:u.content,summary:u.summary,title:u.title,type_id:u.type_id,covers:u.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(k.push("/admin/products"),_.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to save product",e.errmessage),_.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save product",e),_.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[u,_,k]);function q(e){return function(t){var n=t.target.value;d((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(ie.a)({},e,n))}))}}return Object(te.jsx)(f.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsxs)(et.a,{item:!0,xs:12,children:[Object(te.jsx)(Pe.a,{select:!0,sx:{minWidth:"200px",mr:1},id:"product-category-root",label:"\u4ea7\u54c1\u7c7b\u578b",value:null!==(t=null===S||void 0===S?void 0:S.id)&&void 0!==t?t:"",onChange:function(e){var t=m.find((function(t){return t.id===e.target.value}));C(t)},children:m.filter((function(e){return!e.parent_id})).map((function(e){return Object(te.jsx)(tt.a,{value:e.id,children:e.name},"cate-".concat(e.id))}))}),Object(te.jsx)(Pe.a,{select:!0,sx:{minWidth:"200px"},id:"product-category-child",onChange:function(e){var t=m.find((function(t){return t.id===e.target.value}));d((function(e){return Object(O.a)(Object(O.a)({},e),{},{type:t,type_id:t.id})}))},value:u.type_id>0?u.type_id:"",label:"\u5b50\u7c7b\u578b",children:(S?m.filter((function(e){return e.parent_id===S.id})):[]).map((function(e){return Object(te.jsx)(tt.a,{value:e.id,children:e.name},e.id)}))})]}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6807\u9898",value:null!==(n=null===u||void 0===u?void 0:u.title)&&void 0!==n?n:"",onChange:q("title")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:null!==(i=null===u||void 0===u?void 0:u.summary)&&void 0!==i?i:"",onChange:q("summary")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(te.jsxs)("label",{htmlFor:"upload-cover",children:[Object(te.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),G.postImage(n).subscribe({next:function(e){d((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:u.id,img:e.data.url}),Object(O.a)(Object(O.a)({},t),{},{covers:a})}))},error:function(e){console.error("fail to upload image",e),_.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(te.jsx)(Je.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(nt.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(r=null===(c=u.covers)||void 0===c?void 0:c.map((function(e){return Object(te.jsx)(at.a,{children:Object(te.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""})},e.id)})))&&void 0!==r?r:Object(te.jsx)("div",{})})})]})})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(te.jsx)(et.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(te.jsx)(it.CKEditor,{config:{extraPlugins:[lt]},editor:ct.a,data:u.content,onChange:function(e,t){var n=t.getData();d((function(e){return Object(O.a)(Object(O.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},jt=n(212),bt=n.n(jt),ft=n(214),ht=function(e){var t=e.status,n=e.isCreate,i=Object(a.useState)(null),r=Object(b.a)(i,2),c=r[0],o=r[1];function s(){o(null)}function l(){U.save(),s()}return Object(te.jsxs)("div",{children:[Object(te.jsx)(Je.a,{id:"action-button","aria-controls":"action-menu","aria-haspopup":"true","aria-expanded":c?"true":void 0,variant:"contained",color:t?"success":"info",disableElevation:!0,onClick:function(e){o(e.currentTarget)},endIcon:Object(te.jsx)(bt.a,{}),children:n?"\u65b0\u589e":0===t?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"}),Object(te.jsx)(ft.a,{id:"action-menu",open:!!c,anchorEl:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},MenuListProps:{"aria-labelledby":"long-button"},onClose:s,PaperProps:{style:{width:"160px"}},children:n?Object(te.jsx)(tt.a,{onClick:l,children:"\u4fdd\u5b58"},"edit"):[Object(te.jsx)(tt.a,{onClick:l,children:"\u4fdd\u5b58"},"edit"),Object(te.jsx)(tt.a,{onClick:function(){U.publish(),s()},children:"\u53d1\u5e03"},"publish"),Object(te.jsx)(tt.a,{onClick:function(){U.withdraw(),s()},children:"\u64a4\u7a3f"},"withdraw")]})]})},Ot=function(e){var t=Object(a.useState)({id:0,category:1,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(b.a)(t,2),i=n[0],r=n[1],c=Object(Qe.b)(),o=Object(h.g)(),s=Object(h.h)().params.id;return Object(a.useEffect)((function(){var e=s?[R.getDetail(parseInt(s)).subscribe({next:function(e){return r(e.data.info)},error:function(e){console.error("fail to fetch product detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u4ea7\u54c1\u4fe1\u606f\u5931\u8d25",{variant:"error"})}}),U.handleAction("withdraw").pipe(Object(ut.a)((function(){return R.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/products"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),U.handleAction("publish").pipe(Object(ut.a)((function(){return R.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/products"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object($e.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(te.jsxs)(te.Fragment,{children:[Object(te.jsxs)(et.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(te.jsxs)(et.a,{container:!0,item:!0,xs:12,children:[Object(te.jsx)(et.a,{item:!0,xs:1,sx:{pl:1},children:Object(te.jsx)(Je.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(te.jsx)(et.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(te.jsx)(ht,{status:null===i||void 0===i?void 0:i.status,isCreate:0===(null===i||void 0===i?void 0:i.id)})})]}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(dt,{detail:i})})]}),Object(te.jsx)($,{channel:ee,children:"\u4ea7\u54c1\u4e2d\u5fc3"})]})},pt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:2}),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),c=Object(b.a)(r,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(b.a)(u,2),j=d[0],p=d[1],x=Object(a.useState)({open:!1}),m=Object(b.a)(x,2),v=m[0],w=m[1],S=Object(h.g)(),C=Object(Qe.b)();Object(a.useEffect)((function(){R.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),p(n.total)):(console.error("fail to fetch application list",t),C.enqueueSnackbar(" \u83b7\u53d6\u884c\u4e1a\u5e94\u7528\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch application list",e),C.enqueueSnackbar(" \u83b7\u53d6\u884c\u4e1a\u5e94\u7528\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,C]);var k=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(te.jsx)(o.b,{to:"/admin/applications/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(te.jsx)(y.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(te.jsx)(y.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_time",headerName:"\u521b\u5efa\u65f6\u95f4",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(g.a,{component:o.b,to:"/admin/applications/detail/".concat(e.row.id),children:Object(te.jsx)(He.a,{})}),Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void w({open:!0,message:'\u786e\u8ba4\u5220\u9664\u884c\u4e1a\u5e94\u7528\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){w({open:!1})},onConfirm:function(){R.delete(t.id).pipe(Object(I.a)((function(){i(Object(O.a)({},n)),w({open:!1}),C.enqueueSnackbar(" \u5220\u9664\u884c\u4e1a\u5e94\u7528\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to delete application",e),C.enqueueSnackbar(" \u5220\u9664\u884c\u4e1a\u5e94\u7528\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(te.jsx)(Be.a,{})})]})}}];return Object(te.jsxs)(f.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(te.jsx)(_e.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:j,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:ze},componentsProps:{toolbar:{value:n.kw,setFilter:i}},columns:k,rows:s}),Object(te.jsx)(qe.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){S.push("/admin/applications/create")},children:Object(te.jsx)(Le.a,{})}),Object(te.jsx)(Ye,Object(O.a)({},v)),Object(te.jsx)($,{channel:ee,children:"\u884c\u4e1a\u5e94\u7528"})]})},xt=function(e){var t,n,i=e.detail,r=Object(a.useState)(i),c=Object(b.a)(r,2),o=c[0],s=c[1],l=Object(a.useState)([]),u=Object(b.a)(l,2),d=u[0],j=u[1],p=Object(h.g)(),m=Object(Qe.b)();function v(e){return function(t){var n=t.target.value;s((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(ie.a)({},e,n))}))}}return Object(a.useEffect)((function(){B.getList(2).subscribe((function(e){var t=e.data.list;j(t)}))}),[]),Object(a.useEffect)((function(){return s(i)}),[i]),Object(a.useEffect)((function(){var e=U.handleAction("save").pipe(Object(ut.a)((function(){return o.id?R.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):R.create({category:2,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(p.push("/admin/applications"),m.enqueueSnackbar("  \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to fetch application list",e.errmessage),m.enqueueSnackbar(" \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch application list",e),m.enqueueSnackbar(" \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,m,p]),Object(te.jsx)(f.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{select:!0,sx:{minWidth:"200px"},id:"application-category",onChange:function(e){var t=d.find((function(t){return t.id===e.target.value}));s((function(e){return Object(O.a)(Object(O.a)({},e),{},{type:t,type_id:t.id})}))},value:o.type_id>0?o.type_id:"",label:"\u5e94\u7528\u7c7b\u578b",children:d.map((function(e){return Object(te.jsx)(tt.a,{value:e.id,children:e.name},e.id)}))})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:v("title")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:v("summary")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(te.jsxs)("label",{htmlFor:"upload-cover",children:[Object(te.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),G.postImage(n).subscribe((function(e){s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(O.a)(Object(O.a)({},t),{},{covers:a})}))}))}},onClick:function(e){e.target.value=null}}),Object(te.jsx)(Je.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(nt.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e){return Object(te.jsx)(at.a,{children:Object(te.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""})},e.id)})))&&void 0!==t?t:Object(te.jsx)("div",{})})})]})})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(te.jsx)(et.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(te.jsx)(it.CKEditor,{config:{extraPlugins:[lt]},editor:ct.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(O.a)(Object(O.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},mt=function(e){var t=Object(a.useState)({id:0,category:2,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(b.a)(t,2),i=n[0],r=n[1],c=Object(Qe.b)(),o=Object(h.g)(),s=Object(h.h)().params.id;return Object(a.useEffect)((function(){var e=s?[R.getDetail(parseInt(s)).subscribe({next:function(e){return r(e.data.info)},error:function(e){console.error("fail to fetch application list",e),c.enqueueSnackbar(" \u83b7\u53d6\u5e94\u7528\u8be6\u60c5\u5931\u8d25",{variant:"error"})}}),U.handleAction("withdraw").pipe(Object(ut.a)((function(){return R.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/applications"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),U.handleAction("publish").pipe(Object(ut.a)((function(){return R.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/applications"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object($e.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(te.jsxs)(et.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(te.jsxs)(et.a,{container:!0,item:!0,xs:12,children:[Object(te.jsx)(et.a,{item:!0,xs:1,sx:{pl:1},children:Object(te.jsx)(Je.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(te.jsx)(et.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(te.jsx)(ht,{status:null===i||void 0===i?void 0:i.status,isCreate:0===(null===i||void 0===i?void 0:i.id)})})]}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(xt,{detail:i})})]})},vt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:3}),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),c=Object(b.a)(r,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(b.a)(u,2),j=d[0],p=d[1],x=Object(a.useState)({open:!1}),m=Object(b.a)(x,2),v=m[0],w=m[1],S=Object(h.g)(),C=Object(Qe.b)();Object(a.useEffect)((function(){R.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),p(n.total)):(console.error("fail to fetch news list",t),C.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch news list",e),C.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,C]);var k=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(te.jsx)(o.b,{to:"/admin/news/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(te.jsx)(y.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(te.jsx)(y.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_time",headerName:"\u521b\u5efa\u65f6\u95f4",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(g.a,{component:o.b,to:"/admin/news/detail/".concat(e.row.id),children:Object(te.jsx)(He.a,{})}),Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void w({open:!0,message:'\u786e\u8ba4\u5220\u9664\u65b0\u95fb\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){w({open:!1})},onConfirm:function(){R.delete(t.id).pipe(Object(I.a)((function(){i(Object(O.a)({},n)),w({open:!1}),C.enqueueSnackbar(" \u5220\u9664\u65b0\u95fb\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to delete news",e),C.enqueueSnackbar(" \u5220\u9664\u65b0\u95fb\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(te.jsx)(Be.a,{})})]})}}];return Object(te.jsxs)(f.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(te.jsx)(_e.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:j,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:ze},componentsProps:{toolbar:{value:n.kw,setFilter:i}},columns:k,rows:s}),Object(te.jsx)(qe.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){S.push("/admin/news/create")},children:Object(te.jsx)(Le.a,{})}),Object(te.jsx)(Ye,Object(O.a)({},v)),Object(te.jsx)($,{channel:ee,children:"\u65b0\u95fb\u4e2d\u5fc3"})]})},gt=function(e){var t,n,i=e.detail,r=Object(a.useState)(i),c=Object(b.a)(r,2),o=c[0],s=c[1],l=Object(a.useState)([]),u=Object(b.a)(l,2),d=u[0],j=u[1],p=Object(h.g)(),m=Object(Qe.b)();function v(e){return function(t){var n=t.target.value;s((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(ie.a)({},e,n))}))}}return Object(a.useEffect)((function(){B.getList(3).subscribe((function(e){var t=e.data.list;j(t)}))}),[]),Object(a.useEffect)((function(){return s(i)}),[i]),Object(a.useEffect)((function(){var e=U.handleAction("save").pipe(Object(ut.a)((function(){return o.id?R.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):R.create({category:3,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(p.push("/admin/news"),m.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u6210\u529f",{variant:"success"})):(console.error("fail to save news ",e.errmessage),m.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save news ",e),m.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,m,p]),Object(te.jsx)(f.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{select:!0,sx:{minWidth:"200px"},id:"news-category",onChange:function(e){var t=d.find((function(t){return t.id===e.target.value}));s((function(e){return Object(O.a)(Object(O.a)({},e),{},{type:t,type_id:t.id})}))},value:o.type_id>0?o.type_id:"",label:"\u65b0\u95fb\u7c7b\u578b",children:d.map((function(e){return Object(te.jsx)(tt.a,{value:e.id,children:e.name},e.id)}))})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:v("title")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:v("summary")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(te.jsxs)("label",{htmlFor:"upload-cover",children:[Object(te.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),G.postImage(n).subscribe((function(e){s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(O.a)(Object(O.a)({},t),{},{covers:a})}))}))}},onClick:function(e){e.target.value=null}}),Object(te.jsx)(Je.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(nt.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e){return Object(te.jsx)(at.a,{children:Object(te.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""})},e.id)})))&&void 0!==t?t:Object(te.jsx)("div",{})})})]})})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(te.jsx)(et.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(te.jsx)(it.CKEditor,{config:{extraPlugins:[lt]},editor:ct.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(O.a)(Object(O.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},yt=function(e){var t=Object(a.useState)({id:0,category:3,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(b.a)(t,2),i=n[0],r=n[1],c=Object(Qe.b)(),o=Object(h.g)(),s=Object(h.h)().params.id;return Object(a.useEffect)((function(){var e=s?[R.getDetail(parseInt(s)).subscribe({next:function(e){return r(e.data.info)},error:function(e){console.error("fail to fetch product detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u8be6\u60c5\u5931\u8d25",{variant:"error"})}}),U.handleAction("withdraw").pipe(Object(ut.a)((function(){return R.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/news"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),U.handleAction("publish").pipe(Object(ut.a)((function(){return R.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/news"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object($e.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(te.jsxs)(et.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(te.jsxs)(et.a,{container:!0,item:!0,xs:12,children:[Object(te.jsx)(et.a,{item:!0,xs:1,sx:{pl:1},children:Object(te.jsx)(Je.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(te.jsx)(et.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(te.jsx)(ht,{status:null===i||void 0===i?void 0:i.status,isCreate:0===(null===i||void 0===i?void 0:i.id)})})]}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(gt,{detail:i})})]})},wt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:0}),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),c=Object(b.a)(r,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(b.a)(u,2),j=d[0],p=d[1],x=Object(a.useState)({open:!1}),m=Object(b.a)(x,2),v=m[0],w=m[1],S=Object(h.g)(),C=Object(Qe.b)();Object(a.useEffect)((function(){R.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),p(n.total)):(console.error("fail to fetch others list",t),C.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch others list",e),C.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,C]);var k=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(te.jsx)(o.b,{to:"/admin/others/detail/".concat(e.value),color:"primary",children:e.value})}},{field:"title",headerName:"\u6807\u9898",sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(te.jsx)(y.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(te.jsx)(y.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_time",headerName:"\u521b\u5efa\u65f6\u95f4",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(g.a,{component:o.b,to:"/admin/others/detail/".concat(e.row.id),children:Object(te.jsx)(He.a,{})}),Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void w({open:!0,message:'\u786e\u8ba4\u5220\u9664\u5176\u4ed6\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){w({open:!1})},onConfirm:function(){R.delete(t.id).pipe(Object(I.a)((function(){i(Object(O.a)({},n)),w({open:!1}),C.enqueueSnackbar(" \u5220\u9664\u5176\u4ed6\u4fe1\u606f\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to fetch others list",e),C.enqueueSnackbar(" \u5220\u9664\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(te.jsx)(Be.a,{})})]})}}];return Object(te.jsxs)(f.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(te.jsx)(_e.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:j,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:ze},componentsProps:{toolbar:{value:n.kw,setFilter:i}},columns:k,rows:s}),Object(te.jsx)(qe.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){S.push("/admin/others/create")},children:Object(te.jsx)(Le.a,{})}),Object(te.jsx)(Ye,Object(O.a)({},v)),Object(te.jsx)($,{channel:ee,children:"\u5176\u4ed6"})]})},St=function(e){var t,n,i=e.detail,r=Object(a.useState)(i),c=Object(b.a)(r,2),o=c[0],s=c[1],l=Object(h.g)(),u=Object(Qe.b)();function d(e){return function(t){var n=t.target.value;s((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(ie.a)({},e,n))}))}}return Object(a.useEffect)((function(){return s(i)}),[i]),Object(a.useEffect)((function(){var e=U.handleAction("save").pipe(Object(ut.a)((function(){return o.id?R.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):R.create({category:0,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(l.push("/admin/others"),u.enqueueSnackbar("\u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to save others",e.errmessage),u.enqueueSnackbar(" \u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save others",e),u.enqueueSnackbar(" \u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,u,l]),Object(te.jsx)(f.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{select:!0,sx:{minWidth:"200px",mr:1},id:"other-category-root",label:"\u7c7b\u578b",value:"0",SelectProps:{readOnly:!0},children:Object(te.jsx)(tt.a,{value:"0",children:"\u5176\u4ed6"},"0")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:d("title")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(Pe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:d("summary")})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(te.jsxs)("label",{htmlFor:"upload-cover",children:[Object(te.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),G.postImage(n).subscribe({next:function(e){s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(O.a)(Object(O.a)({},t),{},{covers:a})}))},error:function(e){console.error("fail to upload cover",e),u.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(te.jsx)(Je.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(nt.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e){return Object(te.jsx)(at.a,{children:Object(te.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""})},e.id)})))&&void 0!==t?t:Object(te.jsx)("div",{})})})]})})}),Object(te.jsx)(et.a,{item:!0,container:!0,xs:12,children:Object(te.jsx)(x.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(te.jsxs)(et.a,{container:!0,children:[Object(te.jsx)(et.a,{item:!0,xs:1,children:Object(te.jsx)(y.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(te.jsx)(et.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(te.jsx)(it.CKEditor,{config:{extraPlugins:[lt]},editor:ct.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(O.a)(Object(O.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},Ct=function(e){var t=Object(a.useState)({id:0,category:0,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:0,created_at:"",updated_at:""}),n=Object(b.a)(t,2),i=n[0],r=n[1],c=Object(Qe.b)(),o=Object(h.g)(),s=Object(h.h)().params.id;return Object(a.useEffect)((function(){var e=s?[R.getDetail(parseInt(s)).subscribe({next:function(e){return r(e.data.info)},error:function(e){console.error("fail to fetch others detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}}),U.handleAction("withdraw").pipe(Object(ut.a)((function(){return R.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/others"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),U.handleAction("publish").pipe(Object(ut.a)((function(){return R.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/others"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object($e.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(te.jsxs)(et.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(te.jsxs)(et.a,{container:!0,item:!0,xs:12,children:[Object(te.jsx)(et.a,{item:!0,xs:1,sx:{pl:1},children:Object(te.jsx)(Je.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(te.jsx)(et.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(te.jsx)(ht,{status:null===i||void 0===i?void 0:i.status,isCreate:0===(null===i||void 0===i?void 0:i.id)})})]}),Object(te.jsx)(et.a,{item:!0,xs:12,children:Object(te.jsx)(St,{detail:i})})]})},kt={1:"\u4ea7\u54c1\u7c7b\u578b",2:"\u5e94\u7528\u7c7b\u578b",3:"\u65b0\u95fb\u7c7b\u578b"},_t=function(e){var t=e.filter,n=e.setFilter;function a(e){n((function(t){var n,a;return Object(O.a)(Object(O.a)({},t),{},{offset:0,kw:null!==(n=null===(a=e.target)||void 0===a?void 0:a.value)&&void 0!==n?n:""})}))}return Object(te.jsxs)(et.a,{container:!0,spacing:1,sx:{m:1},children:[Object(te.jsx)(et.a,{item:!0,xs:2,children:Object(te.jsx)(Pe.a,{select:!0,fullWidth:!0,id:"category-filter",label:"\u7c7b\u578b",value:t.category,onChange:function(e){n({limit:t.limit,offset:0,category:e.target.value,kw:""})},children:Object.entries(kt).map((function(e){var t=Object(b.a)(e,2),n=t[0],a=t[1];return Object(te.jsx)(tt.a,{value:parseInt(n),children:a},"category-".concat(n))}))})}),Object(te.jsx)(et.a,{item:!0,xs:3,sx:{display:"flex",alignItems:"center"},children:Object(te.jsx)(Pe.a,{variant:"standard",value:t.kw,onChange:a,placeholder:"\u5173\u952e\u5b57\u67e5\u627e",InputProps:{startAdornment:Object(te.jsx)(Ie.a,{fontSize:"small"}),endAdornment:Object(te.jsx)(g.a,{title:"Clear","aria-label":"Clear",size:"small",style:{visibility:t.kw?"visible":"hidden"},onClick:a,children:Object(te.jsx)(Te.a,{fontSize:"small"})})}})})]})},qt=function(e){var t,n,i=e.category,r=e.title,c=e.open,o=e.typeList,s=e.onSave,l=e.onClose,u=e.typeDetail,d=Object(a.useState)(u),j=Object(b.a)(d,2),f=j[0],h=j[1];return Object(a.useEffect)((function(){h(u)}),[u]),Object(te.jsxs)(Ge.a,{open:c,children:[Object(te.jsx)(Xe.a,{children:r}),c&&Object(te.jsxs)(Ke.a,{children:[Object(te.jsx)(Pe.a,{autoFocus:!0,required:!0,margin:"dense",id:"name",label:"\u540d\u79f0",type:"text",value:null!==(t=null===f||void 0===f?void 0:f.name)&&void 0!==t?t:"",fullWidth:!0,onChange:function(e){h((function(t){return Object(O.a)(Object(O.a)({},t),{},{name:e.target.value})}))}}),1===i&&Object(te.jsxs)(Pe.a,{select:!0,autoFocus:!0,margin:"dense",id:"parent_id",label:"\u7236\u7ea7\u7c7b\u578b",type:"text",value:null!==(n=null===f||void 0===f?void 0:f.parent_id)&&void 0!==n?n:"",fullWidth:!0,onChange:function(e){h((function(t){return Object(O.a)(Object(O.a)({},t),{},{parent_id:e.target.value})}))},SelectProps:{readOnly:(null===f||void 0===f?void 0:f.id)>=0},children:[Object(te.jsx)(tt.a,{value:"",children:"\u65e0"},"empty"),o.map((function(e){return Object(te.jsx)(tt.a,{value:e.id,children:e.name},e.id)}))]})]}),Object(te.jsxs)(Ve.a,{children:[Object(te.jsx)(Je.a,{onClick:function(){l&&l()},children:"\u53d6\u6d88"}),Object(te.jsx)(Je.a,{variant:"contained",onClick:function(){s&&s(f)},children:"\u4fdd\u5b58"})]})]})},Pt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:1}),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)([]),c=Object(b.a)(r,2),o=c[0],s=c[1],l=Object(a.useState)({open:!1,category:-1,typeList:[],title:""}),u=Object(b.a)(l,2),d=u[0],j=u[1],h=Object(a.useState)({open:!1}),p=Object(b.a)(h,2),x=p[0],m=p[1],v=Object(a.useState)((new Date).valueOf()),y=Object(b.a)(v,2),w=y[0],S=y[1],C=Object(Qe.b)();Object(a.useEffect)((function(){var e=B.getList(n.category).subscribe((function(e){var t=e.errcode,n=e.data;0===t?s(n.list):C.enqueueSnackbar("\u83b7\u53d6\u7c7b\u578b\u5217\u8868\u5931\u8d25",{variant:"error"})}));return function(){e.unsubscribe()}}),[n.category,C,w]);var k=[{field:"id",headerName:"\u7c7b\u578bId",sortable:!1},{field:"name",headerName:"\u540d\u79f0",sortable:!1},{field:"parent_id",headerName:"\u7236\u7c7b\u578bid",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void j({open:!0,title:"\u7f16\u8f91".concat(kt[n.category]),category:n.category,typeList:o,onClose:_,onSave:F,typeDetail:t});var t},children:Object(te.jsx)(He.a,{})}),Object(te.jsx)(g.a,{onClick:function(){return t=e.row,void m({open:!0,message:'\u786e\u8ba4\u5220\u9664"'.concat(t.name,'"?'),onClose:function(){m({open:!1})},onConfirm:function(){B.delete(t.id).pipe(Object(I.a)((function(){m({open:!1}),S((new Date).valueOf())}))).subscribe()}});var t},children:Object(te.jsx)(Be.a,{})})]})}}];function _(){j((function(e){return Object(O.a)(Object(O.a)({},e),{},{onSave:null,onClose:null,open:!1})}))}var q={next:function(e){0===e.errcode?(j(null),S((new Date).valueOf())):(console.error("\u4fdd\u5b58\u7c7b\u578b\u5931\u8d25",e.errmessage),C.enqueueSnackbar("\u4fdd\u5b58\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("\u4fdd\u5b58\u7c7b\u578b\u5931\u8d25",e),C.enqueueSnackbar("\u4fdd\u5b58\u5931\u8d25",{variant:"error"})}};function P(e){B.creat({category:e.category,name:e.name,parent_id:e.parent_id}).subscribe(q)}function F(e){B.edit({id:e.id,name:e.name}).subscribe(q)}return Object(te.jsxs)(f.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(te.jsx)(_e.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:o.length,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){i((function(t){return Object(O.a)(Object(O.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:_t},componentsProps:{toolbar:{filter:n,setFilter:i}},columns:k,rows:function(){var e=o;n.kw&&(e=o.filter((function(e){return e.name.includes(n.kw)})));var t=n.offset*n.limit;return e.filter((function(e,a){return a>=t&&a<t+n.limit}))}()}),Object(te.jsx)(qe.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){j({open:!0,title:"\u65b0\u589e".concat(kt[n.category]),category:n.category,typeList:o,onClose:_,onSave:P,typeDetail:{id:-1,name:"",parent_id:null,category:n.category}})},children:Object(te.jsx)(Le.a,{})}),Object(te.jsx)(qt,Object(O.a)({},d)),Object(te.jsx)(Ye,Object(O.a)({},x)),Object(te.jsx)($,{channel:ee,children:"\u7c7b\u578b\u8bbe\u7f6e"})]})},Ft=n(379),It=n(213),Et=n.n(It),Tt=function(){var e=Object(a.useState)((new Date).valueOf()),t=Object(b.a)(e,2),n=t[0],i=t[1],r=Object(a.useState)({email:"",password:"",code:""}),c=Object(b.a)(r,2),o=c[0],s=c[1],l=Object(a.useState)({email:!1,password:!1,code:!1,summary:""}),u=Object(b.a)(l,2),d=u[0],j=u[1],x=Object(h.g)(),m=Object(Qe.b)();function v(e){return function(t){var n;j(Object(O.a)(Object(O.a)({},d),{},Object(ie.a)({},e,!(null===(n=t.target)||void 0===n?void 0:n.value)))),s((function(n){return Object(O.a)(Object(O.a)({},n),{},Object(ie.a)({},e,t.target.value))}))}}var g=Object(a.useMemo)((function(){return"/verify/code?state=".concat(n)}),[n]);return Object(te.jsx)(p.a,{maxWidth:"xs",children:Object(te.jsxs)(f.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(te.jsx)(Ft.a,{sx:{m:1,bgcolor:"secondary.main"},children:Object(te.jsx)(Et.a,{})}),Object(te.jsx)(y.a,{component:"h1",variant:"h5",children:"\u767b\u5f55"}),Object(te.jsxs)(f.a,{component:"form",onSubmit:function(e){if(e.preventDefault(),o.email&&o.password&&o.code)j({email:!1,code:!1,password:!1,summary:""}),Y.signIn(o).subscribe({next:function(e){0===e.errcode?(x.push("/"),window.location.reload()):j(Object(O.a)(Object(O.a)({},d),{},{summary:e.errmessage}))},error:function(e){m.enqueueSnackbar("\u767b\u5f55\u5931\u8d25",{variant:"error"})}});else{var t={email:!o.email,password:!o.password,code:!o.code};j(Object(O.a)(Object(O.a)({},d),t))}},noValidate:!0,sx:{mt:1},children:[Object(te.jsx)(Pe.a,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"\u7535\u5b50\u90ae\u7bb1",name:"email",autoComplete:"email",autoFocus:!0,value:o.email,onChange:v("email"),error:d.email,helperText:d.email&&"\u8bf7\u8f93\u5165\u7535\u5b50\u90ae\u7bb1"}),Object(te.jsx)(Pe.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u5bc6\u7801",type:"password",id:"password",autoComplete:"current-password",value:o.password,onChange:v("password"),error:d.password,helperText:d.password&&"\u8bf7\u8f93\u5165\u5bc6\u7801"}),Object(te.jsx)(Pe.a,{margin:"normal",required:!0,fullWidth:!0,name:"code",label:"\u9a8c\u8bc1\u7801",id:"code",value:o.code,onChange:v("code"),InputProps:{endAdornment:Object(te.jsx)("img",{src:g,onClick:function(){i((new Date).valueOf())},alt:"\u9a8c\u8bc1\u7801"})},error:d.code,helperText:d.code&&"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}),d.summary&&Object(te.jsx)(y.a,{variant:"overline",color:"red",children:d.summary}),Object(te.jsx)(Je.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"\u767b\u5f55"})]})]})})},Dt=function(){var e=Object(h.g)(),t=Object(a.useState)(null),n=Object(b.a)(t,2),i=n[0],r=n[1];return Object(a.useEffect)((function(){var t=Z.getUserInfo().subscribe({next:function(t){401===t.errcode?(e.push("/admin/login"),r(!1)):r(!0)},error:function(t){console.error("fail to get user info",t),e.push("/admin/login"),r(!1)}});return function(){t.unsubscribe()}}),[e,i]),Object(te.jsxs)(f.a,{sx:{height:"100vh",overflowY:"auto"},children:[Object(te.jsx)(h.d,{children:Object(te.jsx)(h.b,{path:"/admin/login",exact:!0,children:Object(te.jsx)(ke,{children:Object(te.jsx)(Tt,{})})})}),i&&Object(te.jsx)(Ce,{children:Object(te.jsxs)(h.d,{children:[Object(te.jsx)(h.b,{path:"/",exact:!0,children:Object(te.jsx)(h.a,{to:"/admin/products"})}),Object(te.jsx)(h.b,{path:"/admin/settings",exact:!0,children:Object(te.jsx)(Pt,{})}),Object(te.jsx)(h.b,{path:"/admin/products",exact:!0,children:Object(te.jsx)(Ze,{})}),Object(te.jsx)(h.b,{path:"/admin/products/create",exact:!0,children:Object(te.jsx)(Ot,{})}),Object(te.jsx)(h.b,{path:"/admin/products/detail/:id",exact:!0,children:Object(te.jsx)(Ot,{})}),Object(te.jsx)(h.b,{path:"/admin/applications",exact:!0,children:Object(te.jsx)(pt,{})}),Object(te.jsx)(h.b,{path:"/admin/applications/create",exact:!0,children:Object(te.jsx)(mt,{})}),Object(te.jsx)(h.b,{path:"/admin/applications/detail/:id",exact:!0,children:Object(te.jsx)(mt,{})}),Object(te.jsx)(h.b,{path:"/admin/news",exact:!0,children:Object(te.jsx)(vt,{})}),Object(te.jsx)(h.b,{path:"/admin/news/create",exact:!0,children:Object(te.jsx)(yt,{})}),Object(te.jsx)(h.b,{path:"/admin/news/detail/:id",exact:!0,children:Object(te.jsx)(yt,{})}),Object(te.jsx)(h.b,{path:"/admin/others",exact:!0,children:Object(te.jsx)(wt,{})}),Object(te.jsx)(h.b,{path:"/admin/others/create",exact:!0,children:Object(te.jsx)(Ct,{})}),Object(te.jsx)(h.b,{path:"/admin/others/detail/:id",exact:!0,children:Object(te.jsx)(Ct,{})})]})})]})},Mt=function(e){return Object(te.jsxs)(s.a,{theme:j,children:[Object(te.jsx)(l.a,{}),Object(te.jsx)(Qe.a,{maxSnack:3,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(te.jsx)(Dt,{})})]})};c.a.render(Object(te.jsx)(i.a.StrictMode,{children:Object(te.jsx)(o.a,{children:Object(te.jsx)(Mt,{})})}),document.getElementById("root"));var Nt=document.body.querySelector('input[name="_token"]');Nt?function(e){L.defaults.headers.common["X-CSRF-TOKEN"]=e}(Nt.value):console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token")}},[[287,1,2]]]);
//# sourceMappingURL=main.9b8185c7.chunk.js.map