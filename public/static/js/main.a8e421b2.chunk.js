(this.webpackJsonpsimplecms=this.webpackJsonpsimplecms||[]).push([[0],{272:function(e,t){},288:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(66),c=n.n(i),o=n(31),s=n(400),l=n(371),u=n(88),d=n(81),j=n(51),b=n(29),f=Object(d.b)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:u.a.A400}}},j.b,b.r),h=n(7),O=n(388),x=n(15),p=n(11),m=n(389),v=n(224),g=n(6),y=n(384),w=n(89),S=n(140),C=n(90),k=n(386),_=n(206),q=n.n(_),P=n(25),I=n(68),F=n(361),E=new(function(){function e(){Object(P.a)(this,e),this.loadingSubject=new F.a(!1)}return Object(I.a)(e,[{key:"setLoading",value:function(e){this.loadingSubject.next(e)}},{key:"subscribe",value:function(){return this.loadingSubject.asObservable()}}]),e}()),T=n(372),D=n(362),M=n(385),N=n(204),z=n(363),W=n(364),L=n(365),A=n(153),H=n.n(A),R=H.a.create({timeout:6e3,headers:{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"XMLHttpRequest"},withCredentials:!0});var B=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(T.a)({}).pipe(Object(D.a)((function(){return E.setLoading(!0)})),Object(M.a)((function(){return R.request(Object.assign({},n,{url:e,method:t}))})),Object(N.a)((function(e){return e.data})),Object(z.a)((function(e){return Object(W.a)(e)})),Object(L.a)((function(){return E.setLoading(!1)})))},G=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{headers:{"Content-Type":"multipart/form-data"}};return Object(T.a)({}).pipe(Object(D.a)((function(){return E.setLoading(!0)})),Object(M.a)((function(){return H.a.post(e,t,n)})),Object(N.a)((function(e){return e.data})),Object(z.a)((function(e){return Object(W.a)(e)})),Object(L.a)((function(){return E.setLoading(!1)})))},X=new function e(){Object(P.a)(this,e),this.getList=function(e){return B("/admin/article/list","GET",{params:e})},this.getDetail=function(e){return B("/admin/article/info","GET",{params:{id:e}})},this.create=function(e){return B("/admin/article/add","POST",{data:e})},this.edit=function(e){return B("/admin/article/edit","POST",{data:e})},this.delete=function(e){return B("/admin/article/del","POST",{data:{id:e}})},this.publish=function(e){return B("/admin/article/publish","POST",{params:{id:e}})},this.withdraw=function(e){return B("/admin/article/withdraw","POST",{params:{id:e}})}},K=new function e(){Object(P.a)(this,e),this.getList=function(e){return B("/admin/article/type/list","GET",{params:{category:e}})},this.creat=function(e){return B("/admin/article/type/add","POST",{data:e})},this.edit=function(e){return B("/admin/article/type/edit","POST",{data:e})},this.delete=function(e){return B("/admin/article/type/del","POST",{data:{id:e}})}},U=new function e(){Object(P.a)(this,e),this.postImage=function(e){return G("/admin/upload/image",e)},this.postVideo=function(e){return G("/admin/upload/video",e)}},V=n(216),J=n(366),Y=new function e(){var t=this;Object(P.a)(this,e),this.actionSubject=new V.a,this.save=function(){t.actionSubject.next("save")},this.publish=function(){t.actionSubject.next("publish")},this.withdraw=function(){t.actionSubject.next("withdraw")},this.handleAction=function(e){return t.actionSubject.pipe(Object(J.a)((function(t){return t===e})))}},Q=n(205),Z=n.n(Q),$=new function e(){Object(P.a)(this,e),this.signIn=function(e){var t=e.email,n=e.password,a=e.code,r=Z()(n).toString();return B("/admin/login","POST",{data:{email:t,password:r,code:a}})},this.signOut=function(){return B("/admin/logout","GET")}},ee=new(function(){function e(){Object(P.a)(this,e),this._portalMessageSubject=new F.a(null)}return Object(I.a)(e,[{key:"publish",value:function(e){this._portalMessageSubject.next(e)}},{key:"onMessage",value:function(e){return this._portalMessageSubject.pipe(Object(J.a)((function(t){return(null===t||void 0===t?void 0:t.type)===e})),Object(N.a)((function(e){return e.body})))}}]),e}()),te=new function e(){Object(P.a)(this,e),this.getUserInfo=function(){return B("/admin/self/user/info","GET")}},ne=function(e){var t=e.children,n=e.channel;return Object(a.useEffect)((function(){ee.publish({type:n,body:t})}),[t,n]),null},ae="appBarTitle",re=n(1),ie=Object(g.a)(k.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(p.a)({zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},n&&{marginLeft:"200px",transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})})})),ce=function(e){var t=e.open,n=e.toggleDrawer,r=Object(a.useState)(null),i=Object(h.a)(r,2),c=i[0],o=i[1];Object(a.useEffect)((function(){var e=ee.onMessage(ae).subscribe((function(e){o(e)}));return function(){e.unsubscribe()}}),[]);return Object(re.jsx)(ie,{position:"absolute",open:t,children:Object(re.jsxs)(y.a,{sx:{pr:"24px"},children:[Object(re.jsx)(w.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:n,sx:{marginRight:"36px"},children:Object(re.jsx)(q.a,{})}),Object(re.jsx)(S.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1},children:c}),Object(re.jsx)(C.a,{onClick:function(){$.signOut().subscribe({next:function(){window.location.reload()}})},sx:{color:"#fff"},variant:"text",children:"\u6ce8\u9500"})]})})},oe=n(3),se=n(368),le=n(383),ue=n(375),de=n(220),je=n(369),be=n(387),fe=n(208),he=n.n(fe),Oe=n(209),xe=n.n(Oe),pe=n(210),me=n.n(pe),ve=n(211),ge=n.n(ve),ye=n(212),we=n.n(ye),Se=function(e){return{width:200,marginTop:"64px",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}},Ce=Object(g.a)("div")((function(e){var t=e.theme;return Object(p.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(-1,1)},t.mixins.toolbar)})),ke=Object(g.a)(be.a)((function(e){var t,n=e.theme,a=e.open;return Object(p.a)(Object(p.a)({width:200,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},a&&{width:200,transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen}),overflowX:"hidden","& .MuiDrawer-paper":Se(n)}),!a&&(t={transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(n.spacing(7)," + 1px)")},Object(oe.a)(t,n.breakpoints.up("sm"),{width:"calc(".concat(n.spacing(9)," + 1px)")}),Object(oe.a)(t,"& .MuiDrawer-paper",function(e){return Object(oe.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginTop:"64px",overflowX:"hidden",width:"calc(".concat(e.spacing(6)," + 1px)")},e.breakpoints.up("sm"),{width:"calc(".concat(e.spacing(7)," + 1px)")})}(n)),t))})),_e=function(e){var t=e.open;e.toggleDrawer;return Object(re.jsxs)(ke,{variant:"permanent",open:t,children:[Object(re.jsx)(se.a,{}),Object(re.jsx)(le.a,{children:Object(re.jsxs)("div",{children:[Object(re.jsx)(o.b,{to:"/admin/products",children:Object(re.jsxs)(ue.a,{children:[Object(re.jsx)(de.a,{children:Object(re.jsx)(he.a,{})}),Object(re.jsx)(je.a,{primary:"\u4ea7\u54c1\u4e2d\u5fc3"})]})}),Object(re.jsx)(o.b,{to:"/admin/applications",children:Object(re.jsxs)(ue.a,{children:[Object(re.jsx)(de.a,{children:Object(re.jsx)(xe.a,{})}),Object(re.jsx)(je.a,{primary:"\u884c\u4e1a\u5e94\u7528"})]})}),Object(re.jsx)(o.b,{to:"/admin/news",children:Object(re.jsxs)(ue.a,{children:[Object(re.jsx)(de.a,{children:Object(re.jsx)(me.a,{})}),Object(re.jsx)(je.a,{primary:"\u65b0\u95fb\u4e2d\u5fc3"})]})}),Object(re.jsx)(o.b,{to:"/admin/others",children:Object(re.jsxs)(ue.a,{children:[Object(re.jsx)(de.a,{children:Object(re.jsx)(ge.a,{})}),Object(re.jsx)(je.a,{primary:"\u5176\u4ed6"})]})})]})}),Object(re.jsx)(se.a,{}),Object(re.jsx)(le.a,{children:Object(re.jsx)("div",{children:Object(re.jsx)(o.b,{to:"/admin/settings",children:Object(re.jsxs)(ue.a,{children:[Object(re.jsx)(de.a,{children:Object(re.jsx)(we.a,{})}),Object(re.jsx)(je.a,{primary:"\u7a3f\u4ef6\u7c7b\u578b\u7ba1\u7406"})]})})})})]})},qe=function(e){var t=e.children,n=Object(a.useState)(!0),r=Object(h.a)(n,2),i=r[0],c=r[1],o=function(){c(!i)};return Object(re.jsxs)(a.Fragment,{children:[Object(re.jsx)(ce,{open:i,toggleDrawer:o}),Object(re.jsx)(_e,{open:i,toggleDrawer:o}),Object(re.jsxs)(O.a,{component:"main",sx:Object(p.a)({flexGrow:1,height:"100vh",overflow:"auto",display:"flex",flexDirection:"column",marginLeft:"64px",transition:function(e){return e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})}},i&&{marginLeft:"200px",transition:function(e){return e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})}}),children:[Object(re.jsx)(Ce,{}),Object(re.jsx)(m.a,{maxWidth:"lg",children:Object(re.jsx)(v.a,{sx:{mt:4,mb:4,height:"100%"},children:t})})]})]})},Pe=function(e){return Object(re.jsx)(O.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:e.children})},Ie=n(395),Fe=n(161),Ee=n(129),Te=n.n(Ee),De=n(130),Me=n.n(De),Ne=n(373),ze=Object(g.a)("div")((function(e){var t,n=e.theme;return{padding:n.spacing(.5,.5,0),justifyContent:"space-between",display:"flex",alignItems:"flex-start",flexWrap:"wrap","& MuiTextField-root":(t={},Object(oe.a)(t,n.breakpoints.down("xs"),{width:"100%"}),Object(oe.a)(t,"margin",n.spacing(1,.5,1.5)),Object(oe.a)(t,"& .MuiSvgIcon-root",{marginRight:n.spacing(.5)}),Object(oe.a)(t,"& .MuiInput-underline:before",{borderBottom:"1px solid ".concat(n.palette.divider)}),t)}})),We=new V.a,Le=function(e){var t=Object(a.useRef)(null);return Object(a.useEffect)((function(){var t=We.pipe(Object(Ne.a)(1500),Object(D.a)((function(t){e.setFilter((function(e){return Object(p.a)(Object(p.a)({},e),{},{kw:t,offset:0})}))}))).subscribe();return function(){t.unsubscribe()}}),[e]),Object(re.jsx)(ze,{children:Object(re.jsx)(Fe.a,{inputRef:t,variant:"standard",defaultValue:e.value,onChange:function(e){We.next(null===e||void 0===e?void 0:e.target.value)},placeholder:"\u5173\u952e\u5b57\u67e5\u627e",InputProps:{startAdornment:Object(re.jsx)(Te.a,{fontSize:"small"}),endAdornment:Object(re.jsx)(w.a,{title:"Clear","aria-label":"Clear",size:"small",style:{visibility:e.value?"visible":"hidden"},onClick:function(){t.current.value="",We.next("")},children:Object(re.jsx)(Me.a,{fontSize:"small"})})}})})},Ae=n(64),He=n.n(Ae),Re=n(62),Be=n.n(Re),Ge=n(63),Xe=n.n(Ge),Ke=n(390),Ue=n(391),Ve=n(392),Je=n(393),Ye=n(394),Qe=function(e){var t=e.open,n=e.message,a=e.onClose,r=e.onConfirm;return Object(re.jsxs)(Ke.a,{maxWidth:"xs",open:t,children:[Object(re.jsx)(Ue.a,{children:"\u786e\u8ba4\u5220\u9664"}),Object(re.jsx)(Ve.a,{dividers:!0,children:n&&Object(re.jsx)(Je.a,{children:"\u786e\u8ba4\u5220\u9664?"})}),Object(re.jsxs)(Ye.a,{children:[Object(re.jsx)(C.a,{autoFocus:!0,onClick:a,children:"\u53d6\u6d88"}),Object(re.jsx)(C.a,{color:"warning",onClick:r,children:"\u786e\u8ba4"})]})]})},Ze=n(22),$e=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:1}),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(h.a)(i,2),s=c[0],l=c[1],u=Object(a.useState)(1),d=Object(h.a)(u,2),b=d[0],f=d[1],m=Object(a.useState)({open:!1}),v=Object(h.a)(m,2),g=v[0],y=v[1],C=Object(x.g)(),k=Object(Ze.b)();Object(a.useEffect)((function(){X.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),f(n.total)):(console.error("fetch products error",t),k.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fetch products error",e),k.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,k]);var _=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(re.jsx)(o.b,{to:"/admin/products/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",flex:1,sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(re.jsx)(S.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(re.jsx)(S.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_at",headerName:"\u521b\u5efa\u65f6\u95f4",flex:1,sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.a,{component:o.b,to:"/admin/products/detail/".concat(e.row.id),children:Object(re.jsx)(Be.a,{})}),Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void y({open:!0,message:'\u786e\u8ba4\u5220\u9664\u4ea7\u54c1\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){y({open:!1})},onConfirm:function(){X.delete(t.id).pipe(Object(D.a)((function(){r(Object(p.a)({},n)),y({open:!1}),k.enqueueSnackbar("\u5220\u9664\u4ea7\u54c1\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){k.enqueueSnackbar(" \u5220\u9664\u4ea7\u54c1\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(re.jsx)(Xe.a,{})})]})}}];return Object(re.jsxs)(O.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(re.jsx)(j.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:b,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:Le},componentsProps:{toolbar:{value:n.kw,setFilter:r}},columns:_,rows:s}),Object(re.jsx)(Ie.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){C.push("/admin/products/create")},children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Qe,Object(p.a)({},g)),Object(re.jsx)(ne,{channel:ae,children:"\u4ea7\u54c1\u4e2d\u5fc3"})]})},et=n(76),tt=n(379),nt=n(60),at=n(397),rt=n(398),it=n(399),ct=n(79),ot=n.n(ct),st=n(77),lt=n(78),ut=n.n(lt),dt=n(396),jt=function e(t){var n=this;Object(P.a)(this,e),this.loader=void 0,this._uploadTask=void 0,this.upload=function(){var e=new FormData;return n.loader.file.then((function(t){return e.append("file",t),Object(dt.a)(U.postImage(e)).then((function(e){return 0!==e.errcode?{default:"https://33333.cdn.cke-cs.com/rc1DFuFpHqcR3Mah6y0e/images/a941c59ff780060b51d398434c99fe9f229615b4227f5434.png"}:{default:e.data.url}})).catch((function(){return{default:"https://33333.cdn.cke-cs.com/rc1DFuFpHqcR3Mah6y0e/images/a941c59ff780060b51d398434c99fe9f229615b4227f5434.png"}}))}))},this.abort=function(){n._uploadTask.unsubscribe()},this.loader=t};function bt(e){e.plugins.get("FileRepository").createUploadAdapter=function(e){return new jt(e)}}var ft=n(370),ht=function(e){var t,n,r,i,c,o=e.detail,s=Object(a.useState)(o),l=Object(h.a)(s,2),u=l[0],d=l[1],j=Object(a.useState)([]),b=Object(h.a)(j,2),f=b[0],m=b[1],g=Object(a.useState)(null),y=Object(h.a)(g,2),k=y[0],_=y[1],q=Object(x.g)(),P=Object(Ze.b)();Object(a.useEffect)((function(){d(o)}),[o]),Object(a.useEffect)((function(){K.getList(1).subscribe({next:function(e){var t=e.data.list;m(t)},error:function(e){console.error("fail to fetch article type list",e),P.enqueueSnackbar("\u83b7\u53d6\u4ea7\u54c1\u7c7b\u578b\u4fe1\u606f\u5931\u8d25",{variant:"error"})}})}),[P]),Object(a.useEffect)((function(){if(u.type_id>=0){var e=f.find((function(e){var t;return e.id===(null===(t=u.type)||void 0===t?void 0:t.parent_id)}));_(e)}}),[f,u.type_id,u.type]),Object(a.useEffect)((function(){var e=Y.handleAction("save").pipe(Object(ft.a)((function(){return u.id?X.edit({content:u.content,id:u.id,summary:u.summary,title:u.title,type_id:u.type_id,covers:u.covers.map((function(e){return e.img}))}):X.create({category:1,content:u.content,summary:u.summary,title:u.title,type_id:u.type_id,covers:u.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(q.push("/admin/products"),P.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to save product",e.errmessage),P.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save product",e),P.enqueueSnackbar("\u4fdd\u5b58\u4ea7\u54c1\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[u,P,q]);function I(e){return function(t){var n=t.target.value;d((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(oe.a)({},e,n))}))}}return Object(re.jsx)(O.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsxs)(tt.a,{item:!0,xs:12,children:[Object(re.jsx)(Fe.a,{select:!0,sx:{minWidth:"200px",mr:1},id:"product-category-root",label:"\u4ea7\u54c1\u7c7b\u578b",value:null!==(t=null===k||void 0===k?void 0:k.id)&&void 0!==t?t:"",onChange:function(e){var t=f.find((function(t){return t.id===e.target.value}));_(t)},children:f.filter((function(e){return!e.parent_id})).map((function(e){return Object(re.jsx)(nt.a,{value:e.id,children:e.name},"cate-".concat(e.id))}))}),Object(re.jsx)(Fe.a,{select:!0,sx:{minWidth:"200px"},id:"product-category-child",onChange:function(e){var t=f.find((function(t){return t.id===e.target.value}));d((function(e){return Object(p.a)(Object(p.a)({},e),{},{type:t,type_id:t.id})}))},value:u.type_id>0?u.type_id:"",label:"\u5b50\u7c7b\u578b",children:(k?f.filter((function(e){return e.parent_id===k.id})):[]).map((function(e){return Object(re.jsx)(nt.a,{value:e.id,children:e.name},e.id)}))})]}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6807\u9898",value:null!==(n=null===u||void 0===u?void 0:u.title)&&void 0!==n?n:"",onChange:I("title")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:null!==(r=null===u||void 0===u?void 0:u.summary)&&void 0!==r?r:"",onChange:I("summary")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(re.jsxs)("label",{htmlFor:"upload-cover",children:[Object(re.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),U.postImage(n).subscribe({next:function(e){0===e.errcode?d((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:u.id,img:e.data.url}),Object(p.a)(Object(p.a)({},t),{},{covers:a})})):(console.error("fail to upload image",e.errmessage),P.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to upload image",e),P.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(re.jsx)(C.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(at.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(i=null===(c=u.covers)||void 0===c?void 0:c.map((function(e,t){return Object(re.jsxs)(rt.a,{children:[Object(re.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""}),Object(re.jsx)(it.a,{position:"top",actionPosition:"right",actionIcon:Object(re.jsx)(w.a,{onClick:function(){return e=t,void d((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.splice(e,1),Object(p.a)(Object(p.a)({},t),{},{covers:a})}));var e},sx:{color:"red"},children:Object(re.jsx)(ot.a,{})})})]},e.id)})))&&void 0!==i?i:Object(re.jsx)("div",{})})})]})})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(re.jsx)(tt.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(re.jsx)(st.CKEditor,{config:{extraPlugins:[bt]},editor:ut.a,data:u.content,onChange:function(e,t){var n=t.getData();d((function(e){return Object(p.a)(Object(p.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},Ot=n(213),xt=n.n(Ot),pt=n(215),mt=function(e){var t=e.status,n=e.isCreate,r=Object(a.useState)(null),i=Object(h.a)(r,2),c=i[0],o=i[1];function s(){o(null)}function l(){Y.save(),s()}return Object(re.jsxs)("div",{children:[Object(re.jsx)(C.a,{id:"action-button","aria-controls":"action-menu","aria-haspopup":"true","aria-expanded":c?"true":void 0,variant:"contained",color:t?"success":"info",disableElevation:!0,onClick:function(e){o(e.currentTarget)},endIcon:Object(re.jsx)(xt.a,{}),children:n?"\u65b0\u589e":0===t?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"}),Object(re.jsx)(pt.a,{id:"action-menu",open:!!c,anchorEl:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},MenuListProps:{"aria-labelledby":"long-button"},onClose:s,PaperProps:{style:{width:"160px"}},children:n?Object(re.jsx)(nt.a,{onClick:l,children:"\u4fdd\u5b58"},"edit"):[Object(re.jsx)(nt.a,{onClick:l,children:"\u4fdd\u5b58"},"edit"),Object(re.jsx)(nt.a,{onClick:function(){Y.publish(),s()},children:"\u53d1\u5e03"},"publish"),Object(re.jsx)(nt.a,{onClick:function(){Y.withdraw(),s()},children:"\u64a4\u7a3f"},"withdraw")]})]})},vt=function(e){var t=Object(a.useState)({id:0,category:1,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(h.a)(t,2),r=n[0],i=n[1],c=Object(Ze.b)(),o=Object(x.g)(),s=Object(x.h)().params.id;return Object(a.useEffect)((function(){var e=s?[X.getDetail(parseInt(s)).subscribe({next:function(e){return i(e.data.info)},error:function(e){console.error("fail to fetch product detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u4ea7\u54c1\u4fe1\u606f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("withdraw").pipe(Object(ft.a)((function(){return X.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/products"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("publish").pipe(Object(ft.a)((function(){return X.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/products"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object(et.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsxs)(tt.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(re.jsxs)(tt.a,{container:!0,item:!0,xs:12,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,sx:{pl:1},children:Object(re.jsx)(C.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(re.jsx)(mt,{status:null===r||void 0===r?void 0:r.status,isCreate:0===(null===r||void 0===r?void 0:r.id)})})]}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(ht,{detail:r})})]}),Object(re.jsx)(ne,{channel:ae,children:"\u4ea7\u54c1\u4e2d\u5fc3"})]})},gt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:2}),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(h.a)(i,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(h.a)(u,2),b=d[0],f=d[1],m=Object(a.useState)({open:!1}),v=Object(h.a)(m,2),g=v[0],y=v[1],C=Object(x.g)(),k=Object(Ze.b)();Object(a.useEffect)((function(){X.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),f(n.total)):(console.error("fail to fetch application list",t),k.enqueueSnackbar(" \u83b7\u53d6\u884c\u4e1a\u5e94\u7528\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch application list",e),k.enqueueSnackbar(" \u83b7\u53d6\u884c\u4e1a\u5e94\u7528\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,k]);var _=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(re.jsx)(o.b,{to:"/admin/applications/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",flex:1,sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(re.jsx)(S.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(re.jsx)(S.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_at",headerName:"\u521b\u5efa\u65f6\u95f4",flex:1,sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.a,{component:o.b,to:"/admin/applications/detail/".concat(e.row.id),children:Object(re.jsx)(Be.a,{})}),Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void y({open:!0,message:'\u786e\u8ba4\u5220\u9664\u884c\u4e1a\u5e94\u7528\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){y({open:!1})},onConfirm:function(){X.delete(t.id).pipe(Object(D.a)((function(){r(Object(p.a)({},n)),y({open:!1}),k.enqueueSnackbar(" \u5220\u9664\u884c\u4e1a\u5e94\u7528\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to delete application",e),k.enqueueSnackbar(" \u5220\u9664\u884c\u4e1a\u5e94\u7528\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(re.jsx)(Xe.a,{})})]})}}];return Object(re.jsxs)(O.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(re.jsx)(j.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:b,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:Le},componentsProps:{toolbar:{value:n.kw,setFilter:r}},columns:_,rows:s}),Object(re.jsx)(Ie.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){C.push("/admin/applications/create")},children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Qe,Object(p.a)({},g)),Object(re.jsx)(ne,{channel:ae,children:"\u884c\u4e1a\u5e94\u7528"})]})},yt=function(e){var t,n,r=e.detail,i=Object(a.useState)(r),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(a.useState)([]),u=Object(h.a)(l,2),d=u[0],j=u[1],b=Object(x.g)(),f=Object(Ze.b)();function m(e){return function(t){var n=t.target.value;s((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(oe.a)({},e,n))}))}}return Object(a.useEffect)((function(){K.getList(2).subscribe((function(e){var t=e.data.list;j(t)}))}),[]),Object(a.useEffect)((function(){return s(r)}),[r]),Object(a.useEffect)((function(){var e=Y.handleAction("save").pipe(Object(ft.a)((function(){return o.id?X.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):X.create({category:2,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(b.push("/admin/applications"),f.enqueueSnackbar("  \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to fetch application list",e.errmessage),f.enqueueSnackbar(" \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch application list",e),f.enqueueSnackbar(" \u4fdd\u5b58\u884c\u4e1a\u4fe1\u606f\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,f,b]),Object(re.jsx)(O.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{select:!0,sx:{minWidth:"200px"},id:"application-category",onChange:function(e){var t=d.find((function(t){return t.id===e.target.value}));s((function(e){return Object(p.a)(Object(p.a)({},e),{},{type:t,type_id:t.id})}))},value:o.type_id>0?o.type_id:"",label:"\u5e94\u7528\u7c7b\u578b",children:d.map((function(e){return Object(re.jsx)(nt.a,{value:e.id,children:e.name},e.id)}))})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:m("title")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:m("summary")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(re.jsxs)("label",{htmlFor:"upload-cover",children:[Object(re.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),U.postImage(n).subscribe({next:function(e){0===e.errcode?s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(p.a)(Object(p.a)({},t),{},{covers:a})})):(console.error("fail to upload cover",e.errmessage),f.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to upload cover",e),f.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(re.jsx)(C.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(at.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e,t){return Object(re.jsxs)(rt.a,{children:[Object(re.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""}),Object(re.jsx)(it.a,{position:"top",actionPosition:"right",actionIcon:Object(re.jsx)(w.a,{onClick:function(){return e=t,void s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.splice(e,1),Object(p.a)(Object(p.a)({},t),{},{covers:a})}));var e},sx:{color:"red"},children:Object(re.jsx)(ot.a,{})})})]},e.id)})))&&void 0!==t?t:Object(re.jsx)("div",{})})})]})})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(re.jsx)(tt.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(re.jsx)(st.CKEditor,{config:{extraPlugins:[bt]},editor:ut.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(p.a)(Object(p.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},wt=function(e){var t=Object(a.useState)({id:0,category:2,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(h.a)(t,2),r=n[0],i=n[1],c=Object(Ze.b)(),o=Object(x.g)(),s=Object(x.h)().params.id;return Object(a.useEffect)((function(){var e=s?[X.getDetail(parseInt(s)).subscribe({next:function(e){return i(e.data.info)},error:function(e){console.error("fail to fetch application list",e),c.enqueueSnackbar(" \u83b7\u53d6\u5e94\u7528\u8be6\u60c5\u5931\u8d25",{variant:"error"})}}),Y.handleAction("withdraw").pipe(Object(ft.a)((function(){return X.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/applications"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("publish").pipe(Object(ft.a)((function(){return X.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/applications"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object(et.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(re.jsxs)(tt.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(re.jsxs)(tt.a,{container:!0,item:!0,xs:12,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,sx:{pl:1},children:Object(re.jsx)(C.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(re.jsx)(mt,{status:null===r||void 0===r?void 0:r.status,isCreate:0===(null===r||void 0===r?void 0:r.id)})})]}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(yt,{detail:r})})]})},St=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:3}),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(h.a)(i,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(h.a)(u,2),b=d[0],f=d[1],m=Object(a.useState)({open:!1}),v=Object(h.a)(m,2),g=v[0],y=v[1],C=Object(x.g)(),k=Object(Ze.b)();Object(a.useEffect)((function(){X.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),f(n.total)):(console.error("fail to fetch news list",t),k.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch news list",e),k.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,k]);var _=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(re.jsx)(o.b,{to:"/admin/news/detail/".concat(e.value),children:e.value})}},{field:"title",headerName:"\u6807\u9898",flex:1,sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(re.jsx)(S.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(re.jsx)(S.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_at",headerName:"\u521b\u5efa\u65f6\u95f4",flex:1,sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.a,{component:o.b,to:"/admin/news/detail/".concat(e.row.id),children:Object(re.jsx)(Be.a,{})}),Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void y({open:!0,message:'\u786e\u8ba4\u5220\u9664\u65b0\u95fb\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){y({open:!1})},onConfirm:function(){X.delete(t.id).pipe(Object(D.a)((function(){r(Object(p.a)({},n)),y({open:!1}),k.enqueueSnackbar(" \u5220\u9664\u65b0\u95fb\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to delete news",e),k.enqueueSnackbar(" \u5220\u9664\u65b0\u95fb\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(re.jsx)(Xe.a,{})})]})}}];return Object(re.jsxs)(O.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(re.jsx)(j.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:b,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:Le},componentsProps:{toolbar:{value:n.kw,setFilter:r}},columns:_,rows:s}),Object(re.jsx)(Ie.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){C.push("/admin/news/create")},children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Qe,Object(p.a)({},g)),Object(re.jsx)(ne,{channel:ae,children:"\u65b0\u95fb\u4e2d\u5fc3"})]})},Ct=function(e){var t,n,r=e.detail,i=Object(a.useState)(r),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(a.useState)([]),u=Object(h.a)(l,2),d=u[0],j=u[1],b=Object(x.g)(),f=Object(Ze.b)();function m(e){return function(t){var n=t.target.value;s((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(oe.a)({},e,n))}))}}return Object(a.useEffect)((function(){K.getList(3).subscribe((function(e){var t=e.data.list;j(t)}))}),[]),Object(a.useEffect)((function(){return s(r)}),[r]),Object(a.useEffect)((function(){var e=Y.handleAction("save").pipe(Object(ft.a)((function(){return o.id?X.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):X.create({category:3,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(b.push("/admin/news"),f.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u6210\u529f",{variant:"success"})):(console.error("fail to save news ",e.errmessage),f.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save news ",e),f.enqueueSnackbar(" \u4fdd\u5b58\u65b0\u95fb\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,f,b]),Object(re.jsx)(O.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{select:!0,sx:{minWidth:"200px"},id:"news-category",onChange:function(e){var t=d.find((function(t){return t.id===e.target.value}));s((function(e){return Object(p.a)(Object(p.a)({},e),{},{type:t,type_id:t.id})}))},value:o.type_id>0?o.type_id:"",label:"\u65b0\u95fb\u7c7b\u578b",children:d.map((function(e){return Object(re.jsx)(nt.a,{value:e.id,children:e.name},e.id)}))})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:m("title")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:m("summary")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(re.jsxs)("label",{htmlFor:"upload-cover",children:[Object(re.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),U.postImage(n).subscribe({next:function(e){0===e.errcode?s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(p.a)(Object(p.a)({},t),{},{covers:a})})):(console.error("fail to upload cover",e.errmessage),f.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to upload cover",e),f.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(re.jsx)(C.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(at.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e,t){return Object(re.jsxs)(rt.a,{children:[Object(re.jsx)("img",{src:"".concat(e.img),srcSet:"".concat(e.img),loading:"lazy",alt:""}),Object(re.jsx)(it.a,{position:"top",actionPosition:"right",actionIcon:Object(re.jsx)(w.a,{onClick:function(){return e=t,void s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.splice(e,1),Object(p.a)(Object(p.a)({},t),{},{covers:a})}));var e},sx:{color:"red"},children:Object(re.jsx)(ot.a,{})})})]},e.id)})))&&void 0!==t?t:Object(re.jsx)("div",{})})})]})})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(re.jsx)(tt.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(re.jsx)(st.CKEditor,{config:{extraPlugins:[bt]},editor:ut.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(p.a)(Object(p.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},kt=function(e){var t=Object(a.useState)({id:0,category:3,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:-1,created_at:"",updated_at:""}),n=Object(h.a)(t,2),r=n[0],i=n[1],c=Object(Ze.b)(),o=Object(x.g)(),s=Object(x.h)().params.id;return Object(a.useEffect)((function(){var e=s?[X.getDetail(parseInt(s)).subscribe({next:function(e){return i(e.data.info)},error:function(e){console.error("fail to fetch product detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u65b0\u95fb\u8be6\u60c5\u5931\u8d25",{variant:"error"})}}),Y.handleAction("withdraw").pipe(Object(ft.a)((function(){return X.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/news"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("publish").pipe(Object(ft.a)((function(){return X.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/news"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object(et.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(re.jsxs)(tt.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(re.jsxs)(tt.a,{container:!0,item:!0,xs:12,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,sx:{pl:1},children:Object(re.jsx)(C.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(re.jsx)(mt,{status:null===r||void 0===r?void 0:r.status,isCreate:0===(null===r||void 0===r?void 0:r.id)})})]}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Ct,{detail:r})})]})},_t=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:0}),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(h.a)(i,2),s=c[0],l=c[1],u=Object(a.useState)(0),d=Object(h.a)(u,2),b=d[0],f=d[1],m=Object(a.useState)({open:!1}),v=Object(h.a)(m,2),g=v[0],y=v[1],C=Object(x.g)(),k=Object(Ze.b)();Object(a.useEffect)((function(){X.getList(n).subscribe({next:function(e){var t=e.errcode,n=e.data;0===t?(l(n.list),f(n.total)):(console.error("fail to fetch others list",t),k.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u5217\u8868\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to fetch others list",e),k.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u5217\u8868\u5931\u8d25",{variant:"error"})}})}),[n,k]);var _=[{field:"id",headerName:"\u7a3f\u4ef6Id",sortable:!1,renderCell:function(e){return Object(re.jsx)(o.b,{to:"/admin/others/detail/".concat(e.value),color:"primary",children:e.value})}},{field:"title",headerName:"\u6807\u9898",flex:1,sortable:!1},{field:"type_id",headerName:"\u7c7b\u578b",sortable:!1,renderCell:function(e){var t,n;return Object(re.jsx)(S.a,{children:null!==(t=null===(n=e.row.type)||void 0===n?void 0:n.name)&&void 0!==t?t:""})}},{field:"status",headerName:"\u72b6\u6001",sortable:!1,renderCell:function(e){return Object(re.jsx)(S.a,{children:0===e.value?"\u8349\u7a3f":"\u5df2\u53d1\u5e03"})}},{field:"read_cnt",headerName:"\u9605\u8bfb\u6b21\u6570",sortable:!1},{field:"created_at",headerName:"\u521b\u5efa\u65f6\u95f4",flex:1,sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",sortable:!1,renderCell:function(e){return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.a,{component:o.b,to:"/admin/others/detail/".concat(e.row.id),children:Object(re.jsx)(Be.a,{})}),Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void y({open:!0,message:'\u786e\u8ba4\u5220\u9664\u5176\u4ed6\u4fe1\u606f: "'.concat(t.title,'"?'),onClose:function(){y({open:!1})},onConfirm:function(){X.delete(t.id).pipe(Object(D.a)((function(){r(Object(p.a)({},n)),y({open:!1}),k.enqueueSnackbar(" \u5220\u9664\u5176\u4ed6\u4fe1\u606f\u6210\u529f",{variant:"success"})}))).subscribe({error:function(e){console.error("fail to fetch others list",e),k.enqueueSnackbar(" \u5220\u9664\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}})}});var t},children:Object(re.jsx)(Xe.a,{})})]})}}];return Object(re.jsxs)(O.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(re.jsx)(j.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:b,rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:Le},componentsProps:{toolbar:{value:n.kw,setFilter:r}},columns:_,rows:s}),Object(re.jsx)(Ie.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){C.push("/admin/others/create")},children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Qe,Object(p.a)({},g)),Object(re.jsx)(ne,{channel:ae,children:"\u5176\u4ed6"})]})},qt=function(e){var t,n,r=e.detail,i=Object(a.useState)(r),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(x.g)(),u=Object(Ze.b)();function d(e){return function(t){var n=t.target.value;s((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(oe.a)({},e,n))}))}}return Object(a.useEffect)((function(){return s(r)}),[r]),Object(a.useEffect)((function(){var e=Y.handleAction("save").pipe(Object(ft.a)((function(){return o.id?X.edit({content:o.content,id:o.id,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))}):X.create({category:0,content:o.content,summary:o.summary,title:o.title,type_id:o.type_id,covers:o.covers.map((function(e){return e.img}))})}))).subscribe({next:function(e){0===e.errcode?(l.push("/admin/others"),u.enqueueSnackbar("\u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u6210\u529f",{variant:"success"})):(console.error("fail to save others",e.errmessage),u.enqueueSnackbar(" \u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to save others",e),u.enqueueSnackbar(" \u4fdd\u5b58\u5176\u4ed6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}});return function(){e.unsubscribe()}}),[o,u,l]),Object(re.jsx)(O.a,{sx:{"& .MuiTextField-root":{mt:1,mb:1}},component:"form",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{select:!0,sx:{minWidth:"200px",mr:1},id:"other-category-root",label:"\u7c7b\u578b",value:"0",SelectProps:{readOnly:!0},children:Object(re.jsx)(nt.a,{value:"0",children:"\u5176\u4ed6"},"0")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6807\u9898",value:o.title,onChange:d("title")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(Fe.a,{fullWidth:!0,label:"\u6458\u8981",rows:"4",value:o.summary,onChange:d("summary")})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5c01\u9762"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:!0,justifyContent:"flex-end",children:Object(re.jsxs)("label",{htmlFor:"upload-cover",children:[Object(re.jsx)("input",{style:{display:"none"},accept:"image/*",id:"upload-cover",type:"file",onChange:function(e){var t=e.target.files;if(t&&t.length>0){var n=new FormData;n.append("file",t[0]),U.postImage(n).subscribe({next:function(e){0===e.errcode?s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.push({id:-Math.ceil(1e3*Math.random()),article_id:o.id,img:e.data.url}),Object(p.a)(Object(p.a)({},t),{},{covers:a})})):(console.error("fail to upload cover",e.errmessage),u.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("fail to upload cover",e),u.enqueueSnackbar(" \u4e0a\u4f20\u5c01\u9762\u5931\u8d25",{variant:"error"})}})}},onClick:function(e){e.target.value=null}}),Object(re.jsx)(C.a,{variant:"contained",component:"span",children:"\u6dfb\u52a0\u5c01\u9762"})]})}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(at.a,{sx:{minHeight:"160px",width:"100%"},cols:5,rowHeight:164,children:null!==(t=null===(n=o.covers)||void 0===n?void 0:n.map((function(e,t){return Object(re.jsxs)(rt.a,{children:[Object(re.jsx)("img",{src:"".concat(e.img),alt:""}),Object(re.jsx)(it.a,{position:"top",actionPosition:"right",actionIcon:Object(re.jsx)(w.a,{onClick:function(){return e=t,void s((function(t){var n,a=null!==(n=t.covers)&&void 0!==n?n:[];return a.splice(e,1),Object(p.a)(Object(p.a)({},t),{},{covers:a})}));var e},sx:{color:"red"},children:Object(re.jsx)(ot.a,{})})})]},e.id)})))&&void 0!==t?t:Object(re.jsx)("div",{})})})]})})}),Object(re.jsx)(tt.a,{item:!0,container:!0,xs:12,children:Object(re.jsx)(v.a,{sx:{mt:1,p:1,width:"100%"},variant:"outlined",children:Object(re.jsxs)(tt.a,{container:!0,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,children:Object(re.jsx)(S.a,{variant:"subtitle1",children:"\u5185\u5bb9"})}),Object(re.jsx)(tt.a,{item:!0,sx:{height:"420px","& .ck-editor__main, & .ck-content":{height:"380px"}},xs:12,children:Object(re.jsx)(st.CKEditor,{config:{extraPlugins:[bt]},editor:ut.a,data:o.content,onChange:function(e,t){var n=t.getData();s((function(e){return Object(p.a)(Object(p.a)({},e),{},{content:n})})),console.log("editor update >>>",n)}})})]})})})]})})},Pt=function(e){var t=Object(a.useState)({id:0,category:0,content:"",covers:[],read_cnt:0,status:0,summary:"",title:"",type_id:0,created_at:"",updated_at:""}),n=Object(h.a)(t,2),r=n[0],i=n[1],c=Object(Ze.b)(),o=Object(x.g)(),s=Object(x.h)().params.id;return Object(a.useEffect)((function(){var e=s?[X.getDetail(parseInt(s)).subscribe({next:function(e){return i(e.data.info)},error:function(e){console.error("fail to fetch others detail",e),c.enqueueSnackbar(" \u83b7\u53d6\u5176\u4ed6\u8be6\u7ec6\u4fe1\u606f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("withdraw").pipe(Object(ft.a)((function(){return X.withdraw(parseInt(s))}))).subscribe({next:function(){o.push("/admin/others"),c.enqueueSnackbar(" \u64a4\u7a3f\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u64a4\u7a3f\u5931\u8d25",{variant:"error"})}}),Y.handleAction("publish").pipe(Object(ft.a)((function(){return X.publish(parseInt(s))}))).subscribe({next:function(){o.push("/admin/others"),c.enqueueSnackbar(" \u53d1\u5e03\u6210\u529f",{variant:"success"})},error:function(e){console.error("fail to publish",e),c.enqueueSnackbar(" \u53d1\u5e03\u5931\u8d25",{variant:"error"})}})]:[];return function(){if(e.length>0){var t,n=Object(et.a)(e);try{for(n.s();!(t=n.n()).done;){t.value.unsubscribe()}}catch(a){n.e(a)}finally{n.f()}}}}),[s,c,o]),Object(re.jsxs)(tt.a,{container:!0,spacing:2,sx:{pr:2,pl:1},children:[Object(re.jsxs)(tt.a,{container:!0,item:!0,xs:12,children:[Object(re.jsx)(tt.a,{item:!0,xs:1,sx:{pl:1},children:Object(re.jsx)(C.a,{variant:"outlined",onClick:function(){o.goBack()},children:"\u8fd4\u56de"})}),Object(re.jsx)(tt.a,{item:!0,container:!0,justifyContent:"flex-end",xs:!0,children:Object(re.jsx)(mt,{status:null===r||void 0===r?void 0:r.status,isCreate:0===(null===r||void 0===r?void 0:r.id)})})]}),Object(re.jsx)(tt.a,{item:!0,xs:12,children:Object(re.jsx)(qt,{detail:r})})]})},It={1:"\u4ea7\u54c1\u7c7b\u578b",2:"\u5e94\u7528\u7c7b\u578b",3:"\u65b0\u95fb\u7c7b\u578b"},Ft=function(e){var t=e.filter,n=e.setFilter;function a(e){n((function(t){var n,a;return Object(p.a)(Object(p.a)({},t),{},{offset:0,kw:null!==(n=null===(a=e.target)||void 0===a?void 0:a.value)&&void 0!==n?n:""})}))}return Object(re.jsxs)(tt.a,{container:!0,spacing:1,sx:{m:1},children:[Object(re.jsx)(tt.a,{item:!0,xs:2,children:Object(re.jsx)(Fe.a,{select:!0,fullWidth:!0,id:"category-filter",label:"\u7c7b\u578b",value:t.category,onChange:function(e){n({limit:t.limit,offset:0,category:e.target.value,kw:""})},children:Object.entries(It).map((function(e){var t=Object(h.a)(e,2),n=t[0],a=t[1];return Object(re.jsx)(nt.a,{value:parseInt(n),children:a},"category-".concat(n))}))})}),Object(re.jsx)(tt.a,{item:!0,xs:3,sx:{display:"flex",alignItems:"center"},children:Object(re.jsx)(Fe.a,{variant:"standard",value:t.kw,onChange:a,placeholder:"\u5173\u952e\u5b57\u67e5\u627e",InputProps:{startAdornment:Object(re.jsx)(Te.a,{fontSize:"small"}),endAdornment:Object(re.jsx)(w.a,{title:"Clear","aria-label":"Clear",size:"small",style:{visibility:t.kw?"visible":"hidden"},onClick:a,children:Object(re.jsx)(Me.a,{fontSize:"small"})})}})})]})},Et=function(e){var t,n,r=e.category,i=e.title,c=e.open,o=e.typeList,s=e.onSave,l=e.onClose,u=e.typeDetail,d=Object(a.useState)(u),j=Object(h.a)(d,2),b=j[0],f=j[1];return Object(a.useEffect)((function(){f(u)}),[u]),Object(re.jsxs)(Ke.a,{open:c,children:[Object(re.jsx)(Ue.a,{children:i}),c&&Object(re.jsxs)(Ve.a,{children:[Object(re.jsx)(Fe.a,{autoFocus:!0,required:!0,margin:"dense",id:"name",label:"\u540d\u79f0",type:"text",value:null!==(t=null===b||void 0===b?void 0:b.name)&&void 0!==t?t:"",fullWidth:!0,onChange:function(e){f((function(t){return Object(p.a)(Object(p.a)({},t),{},{name:e.target.value})}))}}),1===r&&Object(re.jsxs)(Fe.a,{select:!0,autoFocus:!0,margin:"dense",id:"parent_id",label:"\u7236\u7ea7\u7c7b\u578b",type:"text",value:null!==(n=null===b||void 0===b?void 0:b.parent_id)&&void 0!==n?n:"",fullWidth:!0,onChange:function(e){f((function(t){return Object(p.a)(Object(p.a)({},t),{},{parent_id:e.target.value})}))},SelectProps:{readOnly:(null===b||void 0===b?void 0:b.id)>=0},children:[Object(re.jsx)(nt.a,{value:"",children:"\u65e0"},"empty"),o.map((function(e){return Object(re.jsx)(nt.a,{value:e.id,children:e.name},e.id)}))]})]}),Object(re.jsxs)(Ye.a,{children:[Object(re.jsx)(C.a,{onClick:function(){l&&l()},children:"\u53d6\u6d88"}),Object(re.jsx)(C.a,{variant:"contained",onClick:function(){s&&s(b)},children:"\u4fdd\u5b58"})]})]})},Tt=function(){var e=Object(a.useState)({kw:"",limit:20,offset:0,category:1}),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(a.useState)({open:!1,category:-1,typeList:[],title:""}),u=Object(h.a)(l,2),d=u[0],b=u[1],f=Object(a.useState)({open:!1}),x=Object(h.a)(f,2),m=x[0],v=x[1],g=Object(a.useState)((new Date).valueOf()),y=Object(h.a)(g,2),S=y[0],C=y[1],k=Object(Ze.b)();Object(a.useEffect)((function(){var e=K.getList(n.category).subscribe((function(e){var t=e.errcode,n=e.data;0===t?s(n.list):k.enqueueSnackbar("\u83b7\u53d6\u7c7b\u578b\u5217\u8868\u5931\u8d25",{variant:"error"})}));return function(){e.unsubscribe()}}),[n.category,k,S]);var _=[{field:"id",headerName:"\u7c7b\u578bId",sortable:!1},{field:"name",headerName:"\u540d\u79f0",flex:1,sortable:!1},{field:"parent_id",headerName:"\u7236\u7c7b\u578bid",sortable:!1},{field:"category",headerName:"\u64cd\u4f5c",flex:1,sortable:!1,renderCell:function(e){return Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void b({open:!0,title:"\u7f16\u8f91".concat(It[n.category]),category:n.category,typeList:o,onClose:P,onSave:E,typeDetail:t});var t},children:Object(re.jsx)(Be.a,{})}),Object(re.jsx)(w.a,{onClick:function(){return t=e.row,void v({open:!0,message:'\u786e\u8ba4\u5220\u9664"'.concat(t.name,'"?'),onClose:function(){v({open:!1})},onConfirm:function(){K.delete(t.id).pipe(Object(D.a)((function(){v({open:!1}),C((new Date).valueOf())}))).subscribe()}});var t},children:Object(re.jsx)(Xe.a,{})})]})}}];var q=function(){var e=o;n.kw&&(e=o.filter((function(e){return e.name.includes(n.kw)})));var t=n.offset*n.limit;return e.filter((function(e,a){return a>=t&&a<t+n.limit}))};function P(){b((function(e){return Object(p.a)(Object(p.a)({},e),{},{onSave:null,onClose:null,open:!1})}))}var I={next:function(e){0===e.errcode?(b(null),C((new Date).valueOf())):(console.error("\u4fdd\u5b58\u7c7b\u578b\u5931\u8d25",e.errmessage),k.enqueueSnackbar("\u4fdd\u5b58\u5931\u8d25",{variant:"error"}))},error:function(e){console.error("\u4fdd\u5b58\u7c7b\u578b\u5931\u8d25",e),k.enqueueSnackbar("\u4fdd\u5b58\u5931\u8d25",{variant:"error"})}};function F(e){K.creat({category:e.category,name:e.name,parent_id:e.parent_id}).subscribe(I)}function E(e){K.edit({id:e.id,name:e.name}).subscribe(I)}return Object(re.jsxs)(O.a,{sx:{height:"100%",width:"100%",p:1},children:[Object(re.jsx)(j.a,{autoHeight:!0,disableColumnMenu:!0,disableColumnFilter:!0,pagination:!0,pageSize:n.limit,page:n.offset,rowCount:q().length,paginationMode:"server",rowsPerPageOptions:[10,20,50,100],onPageChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{offset:e})}))},onPageSizeChange:function(e){r((function(t){return Object(p.a)(Object(p.a)({},t),{},{limit:e,offset:0})}))},components:{Toolbar:Ft},componentsProps:{toolbar:{filter:n,setFilter:r}},columns:_,rows:q()}),Object(re.jsx)(Ie.a,{sx:{position:"fixed",bottom:16,right:48},size:"medium",color:"primary","aria-label":"add",onClick:function(){b({open:!0,title:"\u65b0\u589e".concat(It[n.category]),category:n.category,typeList:o,onClose:P,onSave:F,typeDetail:{id:-1,name:"",parent_id:null,category:n.category}})},children:Object(re.jsx)(He.a,{})}),Object(re.jsx)(Et,Object(p.a)({},d)),Object(re.jsx)(Qe,Object(p.a)({},m)),Object(re.jsx)(ne,{channel:ae,children:"\u7c7b\u578b\u8bbe\u7f6e"})]})},Dt=n(380),Mt=n(214),Nt=n.n(Mt),zt=function(){var e=Object(a.useState)((new Date).valueOf()),t=Object(h.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)({email:"",password:"",code:""}),c=Object(h.a)(i,2),o=c[0],s=c[1],l=Object(a.useState)({email:!1,password:!1,code:!1,summary:""}),u=Object(h.a)(l,2),d=u[0],j=u[1],b=Object(x.g)(),f=Object(Ze.b)();function v(e){return function(t){var n;j(Object(p.a)(Object(p.a)({},d),{},Object(oe.a)({},e,!(null===(n=t.target)||void 0===n?void 0:n.value)))),s((function(n){return Object(p.a)(Object(p.a)({},n),{},Object(oe.a)({},e,t.target.value))}))}}var g=Object(a.useMemo)((function(){return"/verify/code?state=".concat(n)}),[n]);return Object(re.jsx)(m.a,{maxWidth:"xs",children:Object(re.jsxs)(O.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(re.jsx)(Dt.a,{sx:{m:1,bgcolor:"secondary.main"},children:Object(re.jsx)(Nt.a,{})}),Object(re.jsx)(S.a,{component:"h1",variant:"h5",children:"\u767b\u5f55"}),Object(re.jsxs)(O.a,{component:"form",onSubmit:function(e){if(e.preventDefault(),o.email&&o.password&&o.code)j({email:!1,code:!1,password:!1,summary:""}),$.signIn(o).subscribe({next:function(e){0===e.errcode?(b.push("/"),window.location.reload()):(j(Object(p.a)(Object(p.a)({},d),{},{summary:e.errmessage})),r((new Date).valueOf()))},error:function(e){f.enqueueSnackbar("\u767b\u5f55\u5931\u8d25",{variant:"error"}),r((new Date).valueOf())}});else{var t={email:!o.email,password:!o.password,code:!o.code};j(Object(p.a)(Object(p.a)({},d),t))}},noValidate:!0,sx:{mt:1},children:[Object(re.jsx)(Fe.a,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"\u7535\u5b50\u90ae\u7bb1",name:"email",autoComplete:"email",autoFocus:!0,value:o.email,onChange:v("email"),error:d.email,helperText:d.email&&"\u8bf7\u8f93\u5165\u7535\u5b50\u90ae\u7bb1"}),Object(re.jsx)(Fe.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u5bc6\u7801",type:"password",id:"password",autoComplete:"current-password",value:o.password,onChange:v("password"),error:d.password,helperText:d.password&&"\u8bf7\u8f93\u5165\u5bc6\u7801"}),Object(re.jsx)(Fe.a,{margin:"normal",required:!0,fullWidth:!0,name:"code",label:"\u9a8c\u8bc1\u7801",id:"code",value:o.code,onChange:v("code"),InputProps:{endAdornment:Object(re.jsx)("img",{src:g,onClick:function(){r((new Date).valueOf())},alt:"\u9a8c\u8bc1\u7801"})},error:d.code,helperText:d.code&&"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}),d.summary&&Object(re.jsx)(S.a,{variant:"overline",color:"red",children:d.summary}),Object(re.jsx)(C.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"\u767b\u5f55"})]})]})})},Wt=function(){var e=Object(x.g)(),t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){var t=te.getUserInfo().subscribe({next:function(t){401===t.errcode?(e.push("/admin/login"),i(!1)):i(!0)},error:function(t){console.error("fail to get user info",t),e.push("/admin/login"),i(!1)}});return function(){t.unsubscribe()}}),[e,r]),Object(re.jsxs)(O.a,{sx:{height:"100vh",overflowY:"auto"},children:[Object(re.jsx)(x.d,{children:Object(re.jsx)(x.b,{path:"/admin/login",exact:!0,children:Object(re.jsx)(Pe,{children:Object(re.jsx)(zt,{})})})}),r&&Object(re.jsx)(qe,{children:Object(re.jsxs)(x.d,{children:[Object(re.jsx)(x.b,{path:"/",exact:!0,children:Object(re.jsx)(x.a,{to:"/admin/products"})}),Object(re.jsx)(x.b,{path:"/admin/settings",exact:!0,children:Object(re.jsx)(Tt,{})}),Object(re.jsx)(x.b,{path:"/admin/products",exact:!0,children:Object(re.jsx)($e,{})}),Object(re.jsx)(x.b,{path:"/admin/products/create",exact:!0,children:Object(re.jsx)(vt,{})}),Object(re.jsx)(x.b,{path:"/admin/products/detail/:id",exact:!0,children:Object(re.jsx)(vt,{})}),Object(re.jsx)(x.b,{path:"/admin/applications",exact:!0,children:Object(re.jsx)(gt,{})}),Object(re.jsx)(x.b,{path:"/admin/applications/create",exact:!0,children:Object(re.jsx)(wt,{})}),Object(re.jsx)(x.b,{path:"/admin/applications/detail/:id",exact:!0,children:Object(re.jsx)(wt,{})}),Object(re.jsx)(x.b,{path:"/admin/news",exact:!0,children:Object(re.jsx)(St,{})}),Object(re.jsx)(x.b,{path:"/admin/news/create",exact:!0,children:Object(re.jsx)(kt,{})}),Object(re.jsx)(x.b,{path:"/admin/news/detail/:id",exact:!0,children:Object(re.jsx)(kt,{})}),Object(re.jsx)(x.b,{path:"/admin/others",exact:!0,children:Object(re.jsx)(_t,{})}),Object(re.jsx)(x.b,{path:"/admin/others/create",exact:!0,children:Object(re.jsx)(Pt,{})}),Object(re.jsx)(x.b,{path:"/admin/others/detail/:id",exact:!0,children:Object(re.jsx)(Pt,{})})]})})]})},Lt=function(e){return Object(re.jsxs)(s.a,{theme:f,children:[Object(re.jsx)(l.a,{}),Object(re.jsx)(Ze.a,{maxSnack:3,anchorOrigin:{vertical:"top",horizontal:"right"},children:Object(re.jsx)(Wt,{})})]})};c.a.render(Object(re.jsx)(r.a.StrictMode,{children:Object(re.jsx)(o.a,{children:Object(re.jsx)(Lt,{})})}),document.getElementById("root"));var At=document.body.querySelector('input[name="_token"]');At?function(e){R.defaults.headers.common["X-CSRF-TOKEN"]=e}(At.value):console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token")}},[[288,1,2]]]);
//# sourceMappingURL=main.a8e421b2.chunk.js.map